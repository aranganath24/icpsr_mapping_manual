# Practice Exercises

In this section you'll have the opportunity to apply what you learned in Section 4, and practice some of your skills. The following three exercises are arrayed in order of ascending difficulty. 

## Practice Exercise 1

Modify the map we made in Section 4 in the following ways:

* Change the color scheme. What rationale informed your choice of this color scheme? 
* Change the legend breaks. Why did you chose the legend breaks that you did? 
* Replace your name with the current name in the "Map Credits" section. 

What spatial patterns do you notice in this map? Are there any patterns of clustering or dispersion that you find interesting? Do you notice anything surprising or unexpected? And, what future research questions might this map suggest? 

## Practice Exercise 2

Use the same dataset we used in Section 4, but this time please make an interactive map of the country-level average of the "Rigidity_Public_Health" variable. 

## Practice Exercise 3

Refer to the following [dataset](https://www.openicpsr.org/openicpsr/project/121001/version/V1/view?path=/openicpsr/121001/fcr:versions/V1/Index_IPR_Agriculture.xlsx&type=file), entitled "Worldwide Index of IPRs [Intellectual Property Rights] in Agriculture, 1961-2018", which is archived on ICPSR and authored by Mercedes Campi.

Download the dataset, and make a map that shows country-level variation in the "Total_Index" variable in the year 2018. 

## Sample Code

The sample code in this section assumes you've already loaded all of the packages discussed in the tutorial, and have correctly set your working directory to the directory in which the dataset(s) are located. 

### Sample Code for Exercise 2

```{r, include=FALSE}
library(tmap)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(rgeos)
library(tidyverse)
library(readxl)
library(dplyr)
```

```{r, message=FALSE, warning=FALSE, echo=c(-1,-2)}
tmap_mode("plot")
setwd("/Users/adityaranganath/Documents/git_repositories/icpsr_mapping_manual/tutorial_data")

# Imports "Dataset" sheet from ICPSR Excel file into R Studio, and assigns the dataset to an object called "covid_data"
covid_data<-read_excel("Gov_Responses2Covid19_last.xlsx", sheet="Dataset")

# Brings spatial dataset of country boundaries into R environment using the rnaturalearth package
country_boundaries<-ne_countries(scale="medium", returnclass="sf")

# Deletes Antarctica from spatial dataset in "country_boundaries" object
country_boundaries<-country_boundaries %>% filter(iso_a3 !="ATA")

# Selects "iso" and "Rigidity_Public_Health" variables from ICPSR Dataset, and assigns this new dataset to "covid_data_public_health" object
covid_data_public_health<-covid_data %>% 
  select(iso, Rigidity_Public_Health) 

# Changes class of "Rigidity_Public_Health" field from character to numeric
covid_data_public_health$Rigidity_Public_Health<-as.numeric(covid_data_public_health$Rigidity_Public_Health)

# Calculate Country-Level Averages for "Rigidity_Public_Health" Index, and then assign this new dataset of country-level averages to a new object called "covid_data_PH_avg". 
covid_data_PH_avg<-covid_data_public_health %>% group_by(iso) %>% 
                                            summarize(mean_public_health=mean(Rigidity_Public_Health, na.rm=FALSE))

# Join dataset with country-level means for "Rigidity_Public_Health" index (in "covid_data_PH_avg" object) to spatial dataset of world boundaries (in "country_boundaries" object), based on common 3-Digit ISO Codes; then relocate "name" and "mean_economic" fields to the beginning of the dataset so that they're displayed on the map
worldmap_covid_data_PH<-full_join(country_boundaries, covid_data_PH_avg, by=c("iso_a3"="iso")) %>% 
                                relocate(name, mean_public_health)

# Make map and assigns to object called "covid_PH_webmap"
covid_PH_webmap<-tm_shape(worldmap_covid_data_PH)+
                            tm_polygons(col="mean_public_health", n=5, style="jenks", palette="Oranges")

# Set tmap mode to "view
tmap_mode("view")

# display map object in view mode
covid_PH_webmap
```

### Sample Code for Exercise 3

```{r, message=FALSE, warning=FALSE, echo=c(-1,-2)}
tmap_mode("plot")
setwd("/Users/adityaranganath/Documents/git_repositories/icpsr_mapping_manual/tutorial_data")

#Load Tabular Data
IPR_data<-read_excel("Index_IPR_Agriculture.xlsx", sheet="Total_Index")
View(IPR_data)

# Load Spatial Data
country_boundaries<-ne_countries(scale="medium", returnclass="sf")
View(country_boundaries)

# Delete Antarctica
country_boundaries<-country_boundaries %>% filter(iso_a3 !="ATA")

# Check class of Index
class(IPR_data$`Total Index`)

# Select 2015 Observations
IPR_data_2018<-IPR_data %>% filter(year==2018)
View(IPR_data_2018)

# Join Datasets
worldmap_IPR_2018<-full_join(country_boundaries, IPR_data_2018, by=c("iso_a3"="Country_code")) %>% 
                    relocate(Country, 'Total Index')
View(worldmap_IPR_2018)

# Make Map
IPR_2018_map<-tm_shape(worldmap_IPR_2018)+
                tm_polygons(col="Total Index",
                            n=6, 
                            style="jenks", 
                            palette="PuBu",
                            title="Agriculture IPR\nIndex, 2018")+
                tm_layout(frame=FALSE,
                          legend.outside=TRUE,
                          legend.outside.position=c("bottom"),
                          main.title = "Strength of Intellectual Property Protection in Agriculture, 2018",
                          main.title.position = "Center",
                          main.title.size=1,
                          inner.margins=c(0.06,0.10,0.10,0.08),
                          attr.outside=TRUE)+
                tm_credits("Map Author: YOUR NAME\nDataset Author: Mercedes Campi\nCRS:WGS84\nSource:ICPSR",
                           position=c(0.78,0),
                           size=0.38)
# Open Map Object

IPR_2018_map

```



