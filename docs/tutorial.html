<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Tutorial | A Guide to Mapping ICPSR Data in R Studio</title>
  <meta name="description" content="4 Tutorial | A Guide to Mapping ICPSR Data in R Studio" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Tutorial | A Guide to Mapping ICPSR Data in R Studio" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Tutorial | A Guide to Mapping ICPSR Data in R Studio" />
  
  
  

<meta name="author" content="Aditya Ranganath" />


<meta name="date" content="2022-01-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="preliminaries-and-set-up.html"/>
<link rel="next" href="practice-exercises.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Mapping ICPSR Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#motivation"><i class="fa fa-check"></i><b>2.1</b> Motivation</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#scope-and-objectives"><i class="fa fa-check"></i><b>2.2</b> Scope and Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html"><i class="fa fa-check"></i><b>3</b> Preliminaries and Set-Up</a>
<ul>
<li class="chapter" data-level="3.1" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a></li>
<li class="chapter" data-level="3.2" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#r-and-r-studio-installation"><i class="fa fa-check"></i><b>3.2</b> R and R Studio Installation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#windows-installation-instructions"><i class="fa fa-check"></i><b>3.2.1</b> Windows Installation Instructions</a></li>
<li class="chapter" data-level="3.2.2" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#macos-installation-instructions"><i class="fa fa-check"></i><b>3.2.2</b> macOS Installation Instructions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#the-r-studio-interface"><i class="fa fa-check"></i><b>3.3</b> The R Studio Interface</a></li>
<li class="chapter" data-level="3.4" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#install-packages"><i class="fa fa-check"></i><b>3.4</b> Install Packages</a></li>
<li class="chapter" data-level="3.5" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#load-libraries"><i class="fa fa-check"></i><b>3.5</b> Load Libraries</a></li>
<li class="chapter" data-level="3.6" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#set-working-directory"><i class="fa fa-check"></i><b>3.6</b> Set Working Directory</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tutorial.html"><a href="tutorial.html"><i class="fa fa-check"></i><b>4</b> Tutorial</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tutorial.html"><a href="tutorial.html#load-and-view-data"><i class="fa fa-check"></i><b>4.1</b> Load and View Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tutorial.html"><a href="tutorial.html#icpsr-covid-19-tabular-data"><i class="fa fa-check"></i><b>4.1.1</b> ICPSR Covid-19 Tabular Data</a></li>
<li class="chapter" data-level="4.1.2" data-path="tutorial.html"><a href="tutorial.html#country-boundaries-spatial-data"><i class="fa fa-check"></i><b>4.1.2</b> Country Boundaries Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tutorial.html"><a href="tutorial.html#edit-spatial-data"><i class="fa fa-check"></i><b>4.2</b> Edit Spatial Data</a></li>
<li class="chapter" data-level="4.3" data-path="tutorial.html"><a href="tutorial.html#process-icpsr-tabular-data-for-mapping"><i class="fa fa-check"></i><b>4.3</b> Process ICPSR Tabular Data for Mapping</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tutorial.html"><a href="tutorial.html#select-variables"><i class="fa fa-check"></i><b>4.3.1</b> Select Variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="tutorial.html"><a href="tutorial.html#change-class-of-economic_measures-index"><i class="fa fa-check"></i><b>4.3.2</b> Change class of “Economic_Measures” Index</a></li>
<li class="chapter" data-level="4.3.3" data-path="tutorial.html"><a href="tutorial.html#compute-average-of-economic_measures-index"><i class="fa fa-check"></i><b>4.3.3</b> Compute average of “Economic_Measures” index</a></li>
<li class="chapter" data-level="4.3.4" data-path="tutorial.html"><a href="tutorial.html#calculate-summary-statistics"><i class="fa fa-check"></i><b>4.3.4</b> Calculate Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tutorial.html"><a href="tutorial.html#join-datasets"><i class="fa fa-check"></i><b>4.4</b> Join Datasets</a></li>
<li class="chapter" data-level="4.5" data-path="tutorial.html"><a href="tutorial.html#make-a-print-map"><i class="fa fa-check"></i><b>4.5</b> Make a Print Map</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tutorial.html"><a href="tutorial.html#make-a-preliminary-map"><i class="fa fa-check"></i><b>4.5.1</b> Make a Preliminary Map</a></li>
<li class="chapter" data-level="4.5.2" data-path="tutorial.html"><a href="tutorial.html#customize-legend"><i class="fa fa-check"></i><b>4.5.2</b> Customize Legend</a></li>
<li class="chapter" data-level="4.5.3" data-path="tutorial.html"><a href="tutorial.html#add-map-title-and-credits"><i class="fa fa-check"></i><b>4.5.3</b> Add Map Title and Credits</a></li>
<li class="chapter" data-level="4.5.4" data-path="tutorial.html"><a href="tutorial.html#final-map-code"><i class="fa fa-check"></i><b>4.5.4</b> Final Map Code</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tutorial.html"><a href="tutorial.html#export-map"><i class="fa fa-check"></i><b>4.6</b> Export Map</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="tutorial.html"><a href="tutorial.html#export-map-using-tmap"><i class="fa fa-check"></i><b>4.6.1</b> Export Map Using <em>tmap</em></a></li>
<li class="chapter" data-level="4.6.2" data-path="tutorial.html"><a href="tutorial.html#export-map-through-gui"><i class="fa fa-check"></i><b>4.6.2</b> Export Map Through GUI</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="tutorial.html"><a href="tutorial.html#summary"><i class="fa fa-check"></i><b>4.7</b> Summary</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="tutorial.html"><a href="tutorial.html#print-map-summary-script"><i class="fa fa-check"></i><b>4.7.1</b> Print Map Summary Script</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practice-exercises.html"><a href="practice-exercises.html"><i class="fa fa-check"></i><b>5</b> Practice Exercises</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practice-exercises.html"><a href="practice-exercises.html#practice-exercise-1"><i class="fa fa-check"></i><b>5.1</b> Practice Exercise 1</a></li>
<li class="chapter" data-level="5.2" data-path="practice-exercises.html"><a href="practice-exercises.html#practice-exercise-2"><i class="fa fa-check"></i><b>5.2</b> Practice Exercise 2</a></li>
<li class="chapter" data-level="5.3" data-path="practice-exercises.html"><a href="practice-exercises.html#practice-exercise-3"><i class="fa fa-check"></i><b>5.3</b> Practice Exercise 3</a></li>
<li class="chapter" data-level="5.4" data-path="practice-exercises.html"><a href="practice-exercises.html#sample-code-for-practice-exercises"><i class="fa fa-check"></i><b>5.4</b> Sample Code for Practice Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="practice-exercises.html"><a href="practice-exercises.html#sample-code-for-exercise-2"><i class="fa fa-check"></i><b>5.4.1</b> Sample Code for Exercise 2</a></li>
<li class="chapter" data-level="5.4.2" data-path="practice-exercises.html"><a href="practice-exercises.html#sample-code-for-exercise-3"><i class="fa fa-check"></i><b>5.4.2</b> Sample Code for Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="6.1" data-path="conclusion.html"><a href="conclusion.html#wrapping-up"><i class="fa fa-check"></i><b>6.1</b> Wrapping Up</a></li>
<li class="chapter" data-level="6.2" data-path="conclusion.html"><a href="conclusion.html#useful-reading-and-resources"><i class="fa fa-check"></i><b>6.2</b> Useful Reading and Resources</a></li>
<li class="chapter" data-level="6.3" data-path="conclusion.html"><a href="conclusion.html#final-considerations"><i class="fa fa-check"></i><b>6.3</b> Final Considerations</a></li>
<li class="chapter" data-level="6.4" data-path="conclusion.html"><a href="conclusion.html#acknowledgement"><i class="fa fa-check"></i><b>6.4</b> Acknowledgement</a></li>
<li class="chapter" data-level="6.5" data-path="conclusion.html"><a href="conclusion.html#references"><i class="fa fa-check"></i><b>6.5</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide to Mapping ICPSR Data in R Studio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tutorial" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Tutorial</h1>
<p>Now that we’ve taken care of these preliminary steps, we’re ready to begin the tutorial. The steps in the tutorial below will walk through the process of creating world choropleth maps (both print and interactive) based on the dataset discussed in the previous section.</p>
<div id="load-and-view-data" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Load and View Data</h2>
<p>This subsection discusses how to load the tutorial data into our R environment. There are two pieces of data we’ll need to load:</p>
<ul>
<li>The ICPSR tabular dataset on government policy responses to Covid-19 which we’ve already introduced</li>
<li>A spatial dataset of world country boundaries; we will bring this dataset into R Studio via the <code>ne_countries</code> function of the <em>rnaturalearth</em> package</li>
</ul>
<p>We will discuss how to import the ICPSR Covid-19 data in Section 4.1.1, and how to import the spatial dataset of world country boundaries via <em>rnaturalearth</em> in Section 4.1.2.</p>
<div id="icpsr-covid-19-tabular-data" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> ICPSR Covid-19 Tabular Data</h3>
<p>When importing tabular data that we have saved on our computer into R Studio, it’s important to first understand some of the details of the data we’re trying to import. The first thing to note is the type of file we’re working with, which is indicated by the file extension; here, we can note that the ICPSR data’s file extension “.xlsx”, which indicates that it’s an Excel file (but note that .xlsx files can also be opened in spreadsheet software programs other than Excel).</p>
<p>As a result, we’ll have to import this dataset into R Studio using a function designed specifically to handle Excel files. To that end, we’ll use the <code>read_excel</code> function from the <em>readxl</em> package. Recall that if we want to learn more about a function or a package, it’s possible to simply type a question mark followed by the package or function name in the console, and relevant information will appear in the “Help” tab of the “Files/Plots/Packages/Help/Viewer” window on the bottom right of the R Studio interface. For example, if we wanted to learn more about the <code>read_excel</code>function, we could type <code>?read_excel</code> into the console, and view the documentation in the “Help” tab.</p>
<p>Before using the <code>read_excel</code> function to bring the data into our R Studio environment, it could be helpful to inspect the data outside of the R environment, and determine whether the dataset has any features that we have to account for when loading it into our R environment. When we open the downloaded spreadsheet, it will look something like this:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="images/excel_open.png" alt="Screenshot of dataset's description tab opened in spreadsheet software; several variable definitions and descriptions are visible" width="100%" />
<p class="caption">
Figure 4.1: ICPSR dataset in spreadsheet with description tab open
</p>
</div>
<p>Note that immediately after opening the spreadsheet, we will land on its first tab (or “sheet”), which is titled “Description”. This part of the spreadsheet effectively functions as a data codebook, which we can look through to understand the dataset’s various variables and and assess how they were measured. To open up the actual dataset, we can toggle to the “Dataset” tab by pressing the corresponding button on the bottom-left of the spreadsheet (highlighted in red below):</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="images/excel_tabs.png" alt="Screenshot of  dataset open in spreadsheet software with data displayed; dataset tab is active with with red box drawn around tabs on bottom of spreadsheet to show how to toggle between different sheets in spreadsheet software" width="100%" />
<p class="caption">
Figure 4.2: ICPSR dataset open in spreadsheet software with dataset tab open
</p>
</div>
<p>The fact that the ICPSR dataset has two sheets within it is important; it means that when we load it into R, we’ll have to explicitly specify the sheet (i.e. the “Dataset” sheet) that we want to import.</p>
<p>Now, let’s go ahead and load the “Dataset” sheet of the ICPSR data file into R Studio, using the following code:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="tutorial.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loads ICPSR data into R Studio</span></span>
<span id="cb6-2"><a href="tutorial.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">&quot;Gov_Responses2Covid19_last.xlsx&quot;</span>, <span class="at">sheet=</span><span class="st">&quot;Dataset&quot;</span>)</span></code></pre></div>
<p>As we noted above, <code>read_excel</code> is the function used to bring in Excel spreadsheet data into R. The function has two arguments; the first (<code>Gov_Responses2Covid19_last.xlsx</code>) is the name of the file we want to import, while the second (<code>sheet="Dataset"</code>) establishes that we specifically want to import the the “Dataset” sheet from that Excel file.</p>
<p>If the importing process is successful, we will see the dataset print out into our R console. It will look something like this:</p>
<pre><code># A tibble: 62,700 x 43
   country geoid iso   d     cases deaths school school_local domestic domestic_local travel travel_partial travel_dom
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
 1 Aruba   AW    ABW   43831     0      0      0            0       NA             NA     NA             NA         NA
 2 Aruba   AW    ABW   43832     0      0      0            0       NA             NA     NA             NA         NA
 3 Aruba   AW    ABW   43833     0      0      0            0       NA             NA     NA             NA         NA
 4 Aruba   AW    ABW   43834     0      0      0            0       NA             NA     NA             NA         NA
 5 Aruba   AW    ABW   43835     0      0      0            0       NA             NA     NA             NA         NA
 6 Aruba   AW    ABW   43836     0      0      0            0       NA             NA     NA             NA         NA
 7 Aruba   AW    ABW   43837     0      0      0            0       NA             NA     NA             NA         NA
 8 Aruba   AW    ABW   43838     0      0      0            0       NA             NA     NA             NA         NA
 9 Aruba   AW    ABW   43839     0      0      0            0       NA             NA     NA             NA         NA
10 Aruba   AW    ABW   43840     0      0      0            0       NA             NA     NA             NA         NA
# … with 62,690 more rows, and 30 more variables: travel_dom_partial &lt;dbl&gt;, curf &lt;dbl&gt;, curf_partial &lt;dbl&gt;,
#   mass &lt;dbl&gt;, mass_partial &lt;dbl&gt;, elect &lt;dbl&gt;, elect_partial &lt;dbl&gt;, sport &lt;dbl&gt;, sport_partial &lt;dbl&gt;, rest &lt;dbl&gt;,
#   rest_local &lt;dbl&gt;, testing &lt;dbl&gt;, testing_narrow &lt;dbl&gt;, masks &lt;dbl&gt;, masks_partial &lt;dbl&gt;, surveillance &lt;dbl&gt;,
#   surveillance_partial &lt;dbl&gt;, state &lt;dbl&gt;, state_partial &lt;dbl&gt;, cash &lt;dbl&gt;, wage &lt;dbl&gt;, credit &lt;dbl&gt;, taxc &lt;dbl&gt;,
#   taxd &lt;dbl&gt;, export &lt;dbl&gt;, rate &lt;dbl&gt;, Rigidity_Public_Health &lt;chr&gt;, Economic_Measures &lt;chr&gt;,
#   population_2019 &lt;chr&gt;, continent &lt;chr&gt;</code></pre>
<p>Note that when printing a dataset to the console, R Studio will only display the first few records (i.e. rows) in the dataset, and won’t display all of the fields (i.e. columns) either, but rest assured that all of the information has been imported (when printing to the console, R Studio usually truncates the data because of space constraints).</p>
<p>The code above successfully imported the data into R Studio; however, in order to easily work with the data in a scripting environment, we need to assign the data to something called an object.</p>
<p>To understand the concept of object assignment, consider the following simple example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="tutorial.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign value 5 to new object named x</span></span>
<span id="cb8-2"><a href="tutorial.html#cb8-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">5</span></span></code></pre></div>
<p>In the code above, we use R’s assignment operator, <code>&lt;-</code>, to assign the value 5 to an object named “x.” Now that an object named “x” has been created and assigned the value 5, printing “x” in our console (or printing “x” in our script and running it) will return the value 5:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="tutorial.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View contents of object x</span></span>
<span id="cb9-2"><a href="tutorial.html#cb9-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] 5</code></pre>
<p>More generally, the process of assignment effectively equates the output created by the code on the right side of the assignment operator (<code>&lt;-</code>) to an object with a name that is specified on the left side of the assignment operator. Whenever we want to look at the contents of an object (i.e. the output created by the code to the right side of the assignment operator), we simply print the name of the object in the R console (or print the name and run it within a script).</p>
<p>While the example above was very simple, we can assign virtually any R code, and by extension, the data structure(s) generated by that code (such as datasets, maps, graphs) to an R object. Indeed, we’ll use the basic principle of object assignment introduced above to assign our ICPSR dataset of interest to an object, which we will name “covid_data” (note that object names are arbitrary and could be virtually anything, but it is good practice for object names to describe their contents):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="tutorial.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imports &quot;Dataset&quot; sheet from ICPSR Excel file into R Studio, and assigns the dataset to an object named &quot;covid_data&quot;</span></span>
<span id="cb11-2"><a href="tutorial.html#cb11-2" aria-hidden="true" tabindex="-1"></a>covid_data<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;Gov_Responses2Covid19_last.xlsx&quot;</span>, <span class="at">sheet=</span><span class="st">&quot;Dataset&quot;</span>)</span></code></pre></div>
<p>The code above imports the dataset of interest using the code we used above (<code>read_excel("Gov_Responses2Covid19_last.xlsx", sheet="Dataset")</code>, but then takes the additional step of assigning the result of this expression (i.e. the imported ICPSR dataset) on the right side of the assignment operator to an object named <code>covid_data</code>. In other words, the code assigns the output of the expression that results from running <code>read_excel("Gov_Responses2Covid19_last.xlsx", sheet="Dataset")</code> (i.e. the ICPSR dataset) to an object named <code>covid_data</code>.</p>
<p>We can confirm that the ICPSR dataset we imported has been assigned to an object named <code>covid_data</code> by typing and running <code>covid_data</code> in our script (or simply typing it into the console), and seeing that it prints the ICPSR dataset to our console:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="tutorial.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints contents of &quot;covid_data&quot; object to the console</span></span>
<span id="cb12-2"><a href="tutorial.html#cb12-2" aria-hidden="true" tabindex="-1"></a>covid_data</span></code></pre></div>
<pre><code># A tibble: 62,700 x 43
   country geoid iso   d     cases deaths school school_local domestic domestic_local travel travel_partial travel_dom
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
 1 Aruba   AW    ABW   43831     0      0      0            0       NA             NA     NA             NA         NA
 2 Aruba   AW    ABW   43832     0      0      0            0       NA             NA     NA             NA         NA
 3 Aruba   AW    ABW   43833     0      0      0            0       NA             NA     NA             NA         NA
 4 Aruba   AW    ABW   43834     0      0      0            0       NA             NA     NA             NA         NA
 5 Aruba   AW    ABW   43835     0      0      0            0       NA             NA     NA             NA         NA
 6 Aruba   AW    ABW   43836     0      0      0            0       NA             NA     NA             NA         NA
 7 Aruba   AW    ABW   43837     0      0      0            0       NA             NA     NA             NA         NA
 8 Aruba   AW    ABW   43838     0      0      0            0       NA             NA     NA             NA         NA
 9 Aruba   AW    ABW   43839     0      0      0            0       NA             NA     NA             NA         NA
10 Aruba   AW    ABW   43840     0      0      0            0       NA             NA     NA             NA         NA
# … with 62,690 more rows, and 30 more variables: travel_dom_partial &lt;dbl&gt;, curf &lt;dbl&gt;, curf_partial &lt;dbl&gt;,
#   mass &lt;dbl&gt;, mass_partial &lt;dbl&gt;, elect &lt;dbl&gt;, elect_partial &lt;dbl&gt;, sport &lt;dbl&gt;, sport_partial &lt;dbl&gt;, rest &lt;dbl&gt;,
#   rest_local &lt;dbl&gt;, testing &lt;dbl&gt;, testing_narrow &lt;dbl&gt;, masks &lt;dbl&gt;, masks_partial &lt;dbl&gt;, surveillance &lt;dbl&gt;,
#   surveillance_partial &lt;dbl&gt;, state &lt;dbl&gt;, state_partial &lt;dbl&gt;, cash &lt;dbl&gt;, wage &lt;dbl&gt;, credit &lt;dbl&gt;, taxc &lt;dbl&gt;,
#   taxd &lt;dbl&gt;, export &lt;dbl&gt;, rate &lt;dbl&gt;, Rigidity_Public_Health &lt;chr&gt;, Economic_Measures &lt;chr&gt;,
#   population_2019 &lt;chr&gt;, continent &lt;chr&gt;</code></pre>
<p>This suggests that once we’ve created an object through the assignment process discussed above, we can reference an object’s contents by the object’s name. For example, in this case, we can refer to the ICPSR Covid-19 data that has been assigned to the <code>covid_data</code> object as <code>covid_data</code> within our scripts and documentation. In other words, due to the assignment operation, R is able to recognize that whenever we mention <code>covid_data</code>, we are referring to the underlying contents that have been assigned to the <code>covid_data</code> object (i.e. the ICPSR dataset). Throughout the tutorial, we’ll sometimes use object names to refer to the contents that they have been assigned; for instance, when we refer to <code>covid_data</code> or to the <code>covid_data</code> object, we are using shorthand for the ICPSR Covid-19 policy responses dataset that has been assigned to an object with this name.</p>
<p>When we print <code>covid_data</code> in our console (or run it from our script), R will print only a snapshot of the <code>covid_data</code> object to the console. However, it will be useful to inspect the entire dataset of interest within the R interface (without having to open up Excel or other spreadsheet software). We can do so using the <code>View</code> function. In this case, to inspect the ICPSR dataset that we loaded into R Studio and assigned to <code>covid_data</code>, we can pass <code>covid_data</code> as an argument to the <code>View</code> function:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="tutorial.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opens &quot;covid_data&quot; object in R Studio&#39;s data viewer</span></span>
<span id="cb14-2"><a href="tutorial.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_data)</span></code></pre></div>
<p>This will open up the dataset in R Studio’s data viewer within a separate tab in the “Source” window. Within your R Studio environment, the result of running <code>View(covid_data)</code> will look something like this (dataset outlined in red):</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="images/viewdata.png" alt="Screenshot of R Studio interface with covid_data object's contents displayed in R Studio Data Viewer; data viewer is outlined with a red rectangle" width="100%" />
<p class="caption">
Figure 4.3: Viewing ICPSR Dataset in R Studio Data Viewer
</p>
</div>
<p>Note that it is possible to scroll up/down and across the dataset within the data viewer and explore its full dimensions (unlike when printing a dataset to the console).</p>
</div>
<div id="country-boundaries-spatial-data" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Country Boundaries Spatial Data</h3>
<p>Now that we have our tabular data on government responses to Covid-19 loaded into R Studio and assigned to the object named <code>covid_data</code>, let’s now turn to the process of bringing spatial data on world country borders into memory.</p>
<p>When working with spatial data in R, we will sometimes want to import data that is stored on our computer. There are several functions in the <code>sf</code> package that will allow us to easily import saved or downloaded spatial data into R; for more details, please consult the package’s documentation by typing <code>?sf</code> in the console.</p>
<p>In our case, however, we won’t have to download and import the spatial data we need into R Studio from our computer’s local drive. That is because there are R packages that already provide this spatial data, and allow us to directly load it into memory. In particular, we’ll use the <code>ne_countries</code> function of the <em>rnaturalearth</em> package to bring a spatial dataset of country borders into our R environment, and then assign it to an object that we will name <code>country_boundaries</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="tutorial.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Brings spatial dataset of country boundaries into R environment using the rnaturalearth package, and then assigns this dataset to an object named &quot;country_boundaries&quot;</span></span>
<span id="cb15-2"><a href="tutorial.html#cb15-2" aria-hidden="true" tabindex="-1"></a>country_boundaries<span class="ot">&lt;-</span><span class="fu">ne_countries</span>(<span class="at">scale=</span><span class="st">&quot;medium&quot;</span>, <span class="at">returnclass=</span><span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
<p>Note the two arguments we pass to the <code>ne_countries</code> function: the <code>scale</code> argument specifies that we want to use a medium scale when rendering the map (the other options are ‘small’ and ‘large’), while the <code>returnclass</code> argument specifies that we want the spatial dataset in ‘sf’ format, which is a spatial data format that works well with the <em>tmap</em> mapping package (which we’ll introduce and use below).</p>
<p>Now that we have this spatial dataset in memory and assigned to a new object named <code>country_boundaries</code>, let’s step back and clarify what exactly a spatial dataset is. In some respects, a spatial dataset is like a typical tabular dataset. To see this, let’s pass <code>country_boundaries</code> to the <code>View()</code> function to open up the dataset:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="tutorial.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opens contents of &quot;country_boundaries&quot; object in R Studio&#39;s data viewer</span></span>
<span id="cb16-2"><a href="tutorial.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(country_boundaries)</span></code></pre></div>
<p>By scrolling across the dataset, we’ll note that each row corresponds to a country, and that there are many columns that correspond to various country-level attributes. The crucial column, however, which makes this a spatial dataset (as opposed to merely a tabular one), is the information contained in a column called “geometry”. This column contains geographic coordinate information that essentially defines a polygon for each country in the dataset. The “geometry” column is likely one of the last columns in the dataset, so we may have to scroll a bit to find it. Alternatively, we can use the <code>relocate</code> function in the <em>dplyr</em> package to make the “geometry” column the first column in <code>country_boundaries</code>, and then view this reordered dataset using the <code>View</code> function.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="tutorial.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moves &quot;geometry&quot; column to the beginning of the &quot;country_boundaries&quot; dataset</span></span>
<span id="cb17-2"><a href="tutorial.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">relocate</span>(country_boundaries, geometry))</span></code></pre></div>
<p>The first argument passed to the <code>relocate</code> function (<code>country_boundaries</code>) indicates the object we want to manipulate using the <code>relocate</code> function, while the second argument (<code>geometry</code>) indicates the name of the column in <code>country_boundaries</code> that we want to move up to the front of the dataset. Once that column relocation has taken place, the <code>View</code> function brings up the amended dataset as a new tab in the source window. It will look something like this (note the “geometry” column):</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="images/geometry.png" alt="Screenshot of spatial dataset in R Studio data viewer with geometry column moved to the front of the dataset; a red rectangle is drawn around the geometry column" width="100%" />
<p class="caption">
Figure 4.4: Geometry Column Contains Spatial Information
</p>
</div>
<p>We can use the information in the “geometry” column to draw georeferenced polygons for each row in the spatial dataset, which will yield a world map! To translate the information in the geometry tab into a cartographic representation, we’ll use a package called <em>tmap</em>. In particular, we’ll use the <code>tm_shape</code> and <code>tm_polygons</code> functions from <em>tmap</em>, which are connected by a plus sign (+). The argument passed to the <code>tm_shape</code> function is the name of the object associated with the spatial dataset (<code>country_boundaries</code>, defined above). In addition, the <code>tm_polygons</code> function indicates that the spatial data is to be represented using polygons (as opposed to alternatives such as lines or points), and does not require any arguments. When we type in and run the following code from our script, the result is a map that is rendered based on the information in the “geometry” column of <code>country_boundaries</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="tutorial.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># maps geographic features (i.e. countries) of &quot;country_boundaries&quot; using tmap package functions</span></span>
<span id="cb18-2"><a href="tutorial.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(country_boundaries)<span class="sc">+</span></span>
<span id="cb18-3"><a href="tutorial.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-24-1.png" title="World map with countries colored gray; map is bordered with map frame" alt="World map with countries colored gray; map is bordered with map frame" width="672" /></p>
<p>We can assign this map, rendered from <code>country_boundaries</code> using <em>tmap</em>, to a distinct object, just as we assigned the tabular ICPSR dataset and the spatial dataset to distinct objects (<code>covid_data</code> and <code>country_boundaries</code>, respectively). Let’s call this object <code>worldmap</code>; the code below performs this assignment:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="tutorial.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assigns map of geographic features rendered from &quot;country_boundaries&quot; to a new object called &quot;worldmap&quot; </span></span>
<span id="cb19-2"><a href="tutorial.html#cb19-2" aria-hidden="true" tabindex="-1"></a>worldmap<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(country_boundaries)<span class="sc">+</span></span>
<span id="cb19-3"><a href="tutorial.html#cb19-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>()</span></code></pre></div>
<p>Having assigned the map to the <code>worldmap</code> object, we can bring up the map whenever we want by simply calling the <code>worldmap</code> object (i.e. printing <code>worldmap</code> and running it from our script):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="tutorial.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># displays contents of &quot;worldmap&quot; object (i.e. a country-level map generated from the &quot;country_boundaries&quot; spatial dataset)</span></span>
<span id="cb20-2"><a href="tutorial.html#cb20-2" aria-hidden="true" tabindex="-1"></a>worldmap</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-26-1.png" title="World map with countries colored gray; map is bordered with map frame" alt="World map with countries colored gray; map is bordered with map frame" width="672" /></p>
<p>Within the R Studio interface, we can see the above map within the bottom-right window after selecting the “Plots” tab:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="images/worldmap_window.png" alt="Screen shot of world map rendered from spatial dataset displayed in R Studio's Plots tab; the map is bordered with a bounding box, and all countries are displayed in gray" width="100%" />
<p class="caption">
Figure 4.5: World Map in ‘Plots’ Tab (Rendered from Spatial Dataset)
</p>
</div>
<p>We can enlarge the map in this window by clicking the “Zoom” link; this will produce an enlarged version of the map in a separate window:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-28"></span>
<img src="images/zoom2.png" alt="Screen shot that shows enlarged world map rendered from spatial dataset in R Studio's zoom window; the zoom button is highlighted in red" width="100%" />
<p class="caption">
Figure 4.6: Enlarging Map with ‘Zoom’ Button
</p>
</div>
</div>
</div>
<div id="edit-spatial-data" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Edit Spatial Data</h2>
<p>We can edit spatial datasets in R Studio with relative ease, using commonly-used R packages. Let’s say, for example, that we don’t want Antarctica to appear on our map (since Antarctica typically does not appear on political maps of the world).</p>
<p>To delete Antarctica from the map, we first need to delete the row that corresponds to Antarctica in <code>country_boundaries</code>. We can do so with the following code:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="tutorial.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deletes Antarctica from &quot;country_boundaries&quot;</span></span>
<span id="cb21-2"><a href="tutorial.html#cb21-2" aria-hidden="true" tabindex="-1"></a>country_boundaries<span class="ot">&lt;-</span>country_boundaries <span class="sc">%&gt;%</span> <span class="fu">filter</span>(iso_a3 <span class="sc">!=</span><span class="st">&quot;ATA&quot;</span>)</span></code></pre></div>
<p>We can translate this code into ordinary language as follows: “Take the existing country boundaries dataset (<code>country_boundaries</code> to the left of the <code>%&gt;%</code> and to the right of the assignment operator) and then (<code>%&gt;%</code>, a symbol called a pipe, which is used to chain together code) select only the countries that are not Antarctica (<code>filter(iso_a3 !="ATA"</code>). Take this amended (sans Antarctica) spatial dataset, and assign it back to an object named ‘country_boundaries’ (<code>country_boundaries&lt;-</code>); this assignment effectively overwrites the previous dataset that was assigned to <code>country_boundaries</code> (which did include Antarctica) with the amended dataset.”</p>
<p>Two things may require additional elaboration:</p>
<ul>
<li>First is the pipe, the symbol that looks like this: <code>%&gt;%</code>. The pipe operator essentially takes the output of the code on its left, and then use that output as an input to the code on its right. Here, the pipe takes the <code>country_boundaries</code> object on its left, and then feeds this data into the <code>filter</code> function on its right. In other words, the pipe operator links the code on its two sides, and establishes that the data to be “filtered” within the <code>filter</code> function is <code>country_boundaries</code>.</li>
<li>The <code>filter</code> function is a function from the <em>dplyr</em> package that allows one to select rows from a dataset using specified criteria. In our case, we want to select all rows from the dataset that are not Antarctica. The argument passed to the <code>filter</code> function, <code>iso_a3 !="ATA"</code>, is essentially saying “return any records where the”iso_a3” variable (i.e. the 3 digit ISO country code) in the attribute table is NOT equal to “ATA” (Antarctica’s code). Note that <code>!=</code> is R syntax for “not equal to”.<a href="conclusion.html#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></li>
</ul>
<p>Now, let’s see this change reflected in the corresponding map. To do so, we must update the <code>worldmap</code> object by rerunning the object assignment. That is, <code>worldmap</code> will not automatically reflect the edits we just made to the <code>country_boundaries</code> dataset. We need to run the code again (with the new version of <code>country_boundaries</code> passed through the <code>tm_shape</code> function) and then assign the revised map to <code>worldmap</code>, which effectively overwrites the previous map (the one with Antarctica) assigned to <code>worldmap</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="tutorial.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Makes a new map based on the edited &quot;country_boundaries&quot; dataset, and assigns this new map to the &quot;worldmap&quot; object (thereby overwriting the map with Antarctica that was previously assigned to &quot;worldmap&quot;)</span></span>
<span id="cb22-2"><a href="tutorial.html#cb22-2" aria-hidden="true" tabindex="-1"></a>worldmap<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(country_boundaries)<span class="sc">+</span></span>
<span id="cb22-3"><a href="tutorial.html#cb22-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>()</span></code></pre></div>
<p>Now, let’s view our updated map:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="tutorial.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display contents of updated &quot;worldmap&quot; object</span></span>
<span id="cb23-2"><a href="tutorial.html#cb23-2" aria-hidden="true" tabindex="-1"></a>worldmap</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-31-1.png" title="World map without Antarctica; countries are colored gray; map is bordered with map frame" alt="World map without Antarctica; countries are colored gray; map is bordered with map frame" width="672" /></p>
<p>As desired, Antarctica no longer appears on the map associated with “country_boundaries”.</p>
</div>
<div id="process-icpsr-tabular-data-for-mapping" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Process ICPSR Tabular Data for Mapping</h2>
<p>In order to represent the ICPSR data on governments’ economic responses to Covid-19 on a map, we must join the ICPSR dataset (<code>covid_data</code>) to the spatial dataset ( <code>country_boundaries</code>); at that point, we’ll have a new spatial dataset that will include the country-level Covid-19 data that we wish to map. We can then display the Covid-19 policy data on a map by using the <code>tmap</code> package that we have already introduced.</p>
<p>Before we can take those steps, however, we need to process the ICPSR tabular data with a view towards facilitating the joining and mapping process.</p>
<div id="select-variables" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Select Variables</h3>
<p>When working with data in R, it is often useful to get a quick sense of a given dataset’s dimensions, which we can do using the <code>dim</code> function. Below, we pass <code>covid_data</code> to the <code>dim</code> function:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="tutorial.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ascertain dimensions of &quot;covid_data&quot; object</span></span>
<span id="cb24-2"><a href="tutorial.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(covid_data)</span></code></pre></div>
<pre><code>[1] 62700    43</code></pre>
<p>The output indicates that there are 62700 rows in the dataset, and 43 columns. This suggests that there are quite a few variables in the dataset, most of which we won’t need. In particular, given that we’re only interested in mapping (for now) the variable that represents an aggregate index of the generosity of governments’ economic support measures in response to the pandemic, we’ll go ahead and delete superfluous columns so as to keep the size of the final (joined) dataset tractable. The name of the variable we’d like to map, and therefore keep, is “Economic_Measure” (see the dataset’s documentation for more details). In addition to keeping this variable, we also need to keep the column titled “iso”, which is the 3-digit ISO country code; this ISO code also exists in the spatial dataset to which we want to join the “Economic_Measure” variable, and so we will use these ISO codes contained in the two datasets as the joining variable.</p>
<p>Let’s create this smaller dataset, comprised of the ISO code and the economic intervention index that we want to map, and assign it to a new object named “covid_data_economic”:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="tutorial.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select &quot;iso&quot; and &quot;Economic_Measures&quot; columns from &quot;covid_data&quot; dataset, and assign the dataset created through this selection to the &quot;covid_data_economic&quot; object</span></span>
<span id="cb26-2"><a href="tutorial.html#cb26-2" aria-hidden="true" tabindex="-1"></a>covid_data_economic<span class="ot">&lt;-</span>covid_data <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="tutorial.html#cb26-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(iso, Economic_Measures) </span></code></pre></div>
<p>The above code can be translated as follows: “Start with <code>covid_data</code>, and then (<code>%&gt;%</code>) keep the ‘iso’ and ‘Economic_Measures’ columns but discard everything else (`<code>select(iso, Economic_Measures)</code>). Assign this new 2-column dataset to a new object called <code>covid_data_economic</code> (<code>covid_data_economic&lt;-</code>).” We can take a look at this smaller dataset that was extracted from the original dataset by passing the <code>covid_data_economic</code> object as an argument to the now-familiar <code>View</code> function:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="tutorial.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View contents of &quot;covid_data_economic&quot; object in R Studio data viewer</span></span>
<span id="cb27-2"><a href="tutorial.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_data_economic)</span></code></pre></div>
<p>Within the “Source” window, a new tab that contains the smaller 2-column dataset that’s been assigned to <code>covid_data_economic</code> will appear in the data viewer:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="images/selection.png" alt="Screenshot of contents of covid_data_economic object displayed in R Studio data viewer; the object is a two column dataset with one column containing information on ISO codes and the other containing the Economic_Measures data, i.e. the Covid economic index" width="100%" />
<p class="caption">
Figure 4.7: New Dataset Based on Selection from Original Dataset
</p>
</div>
<p>Note that the original Covid-19 policy responses dataset, which we previously assigned to the <code>covid_data</code> object, is unaffected by our creation and assignment of a new dataset based on the selection of these two variables. We can confirm that this original data (<code>covid_data</code>) remains unaffected by inspecting it through a call to the <code>View</code> function:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="tutorial.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View contents of &quot;covid_data&quot; object in R Studio data viewer</span></span>
<span id="cb28-2"><a href="tutorial.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_data)</span></code></pre></div>
<p>We can go back to the <code>covid_data</code> dataset anytime we need, but for now we’ll set it aside and start working with our newly created <code>covid_data_economic</code> dataset.</p>
</div>
<div id="change-class-of-economic_measures-index" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Change class of “Economic_Measures” Index</h3>
<p>Recall that the data we want to map is contained within the “Economic_Measures” column of <code>covid_data_economic</code>. R has six fundamental “types” of data: character, numeric, integer, logical, and complex. The code below extracts the “Economic_Measures” column from the dataset (placing a dollar sign in between the name of the object to which a dataset has been assigned, and the name of a column within that dataset, as in <code>covid_data_economic$Economic_Measures</code>, is a way of isolating and extracting a column from a larger dataset), and then passes it to the <code>class</code> function to identify the class of the data in the “Economic_Measures” field.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="tutorial.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the class of the &quot;Economic_Measures&quot; field within the &quot;covid_data_economic&quot; dataset</span></span>
<span id="cb29-2"><a href="tutorial.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(covid_data_economic<span class="sc">$</span>Economic_Measures)</span></code></pre></div>
<pre><code>[1] &quot;character&quot;</code></pre>
<p>We can see from the above output that the class of the “Economic_Measures” variable is “character”, which implies that although the information in the “Economic_Measures” variable looks like it is numeric, R is not actually reading those data as numbers. So, we have to change the way in which that data is encoded, and ensure that it will be interpreted numerically; the failure to do this will prevent us from making numerical calculations using the information in this colum, as well as from mapping it using <em>tmap</em>.</p>
<p>We can essentially recode the information in the “Economic_Measures” variable as “numeric” using the following expression:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="tutorial.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changes class of &quot;Economic_Measures&quot; field in &quot;covid_data_economic&quot; object from character to numeric</span></span>
<span id="cb31-2"><a href="tutorial.html#cb31-2" aria-hidden="true" tabindex="-1"></a>covid_data_economic<span class="sc">$</span>Economic_Measures<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(covid_data_economic<span class="sc">$</span>Economic_Measures)</span></code></pre></div>
<p>In the code above, the expression to the right of the assignment operator extracts the “Economic_Measures” column from the the <code>covid_data_economic</code> dataset (<code>covid_data_economic$Economic_Measures</code>), and then changes this column’s class to numeric by passing it as an argument to the <code>as.numeric</code> function. The assignment operator then replaces the old version of the “Economic_Measures” column (encoded as character) within <code>covid_data_economic</code>, with this new (numeric) version of the “Economic_Measures” column. At this point, the “Economic_Measures” column in <code>covid_data_economic</code> is numeric; we can confirm this by passing that column through the <code>class</code> function once again:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="tutorial.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checks the class of the updated &quot;Economic_Measures&quot; field</span></span>
<span id="cb32-2"><a href="tutorial.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(covid_data_economic<span class="sc">$</span>Economic_Measures)</span></code></pre></div>
<pre><code>[1] &quot;numeric&quot;</code></pre>
</div>
<div id="compute-average-of-economic_measures-index" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Compute average of “Economic_Measures” index</h3>
<p>As we mentioned earlier, the ICPSR dataset on government policies with respect to Covid-19 is a cross-sectional time-series (i.e. panel) dataset, containing monthly observations over the course of about a year during the pandemic (January 2020 to October 2020). This means that we have to make some choices about how to represent the “Economic_Measures” index on a map. For example, do we want to pick data for a given month, and then map this data? Do we want to use the map to represent change across different months? Do we want to map a summary measure of the “Economic_Measures” data, such as the average index value across all the months in the sample?</p>
<p>There are of many possibilities, but let’s choose to go ahead and map the country-level average for the “Economic_Measures” index across the entire time period covered in the dataset. That is, for each country, we’ll compute the average value of the monthly observations for the “Economic_Measures” index, and then map this average value. To that end, we need to take <code>covid_data_economic</code>, which contains monthly observations for each country, and collapse it into a new dataset that contains the country-level average of the “Economic_Measures” index.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="tutorial.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates new dataset of country-level averages for &quot;Economic_Measures&quot; index, and then assigns this new dataset to a  new object that is named &quot;covid_data_economic_avg&quot;. </span></span>
<span id="cb34-2"><a href="tutorial.html#cb34-2" aria-hidden="true" tabindex="-1"></a>covid_data_economic_avg<span class="ot">&lt;-</span>covid_data_economic <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(iso) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="tutorial.html#cb34-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">summarize</span>(<span class="at">mean_economic=</span><span class="fu">mean</span>(Economic_Measures, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<p>Let’s unpack the code above, starting with the expression that’s to the right of the assignment operator.</p>
<ul>
<li>We start by calling the <code>covid_data_economic</code> object, which establishes that this is essentially the “base” dataset we wish to modify.</li>
<li>Then (recall that the <code>%&gt;%</code> is used to chain together code by taking the output on the left and passing it as input into the code to its right), we call the <code>group_by</code> function, and pass <code>iso</code> as an argument to this function; this stipulates that all observations with the same ISO code are to be considered a group, and that any subsequent calculations will therefore be performed at the country level. This step ensures that when we calculate the mean of the “Economic_Measures” variable, the function will return the mean value of this index for each individual country, rather than the mean value for the dataset as a whole.</li>
<li>After setting the grouping variable and using another pipe (<code>%&gt;%</code>) to establish that we are passing the newly grouped dataset as an input into the subsequent code, we call the <code>summarize</code> function. This function is used to create a new dataset that summarizes an existing dataset with relevant summary statistics (such as the mean or standard deviation). In particular, within the <code>summarize</code> function, we first need to create a name for the column that will contain the country-level averages for the “Economic_Measures” index in the new dataset. We’ll call this variable “mean_economic”, which corresponds to the very first part of the argument to the <code>summarize</code> function. We then set this variable equal to an expression that passes the “Economic_Measures” variable to the <code>mean</code> function. In essence, this expression calculates the mean of the “Economic_Measures” variable for each country (it calculates the country-level mean because we specified the grouping function, <code>group_by(iso)</code>, in the previous line of code), and creates a column in the newly created dataset named “mean_economic” to store this information. The code that reads <code>na.rm=TRUE</code> simply stipulates that missing data should be ignored in the calculation of the mean value of the “Economic_Measures” index.</li>
<li>Finally, this new dataset, consisting of two columns (one column containing ISO codes, and the other, named “mean_economic” containing the corresponding country-level mean of the “Economic_Measures” variable) is assigned to a new object called <code>covid_data_economic_avg</code>.</li>
</ul>
<p>We can translate the above code as follows: “Take the existing <code>covid_data_economic</code> dataset, and then group this dataset by the ISO country codes; then, generate a new dataset, containing one column with ISO country codes, and another column, named”mean_economic”, that contains information on the country-level mean of the ‘Economic_Measures’ index from the <code>covid_data_economic</code> dataset. Finally, assign this new dataset to an object called <code>covid_data_economic_avg</code>“.</p>
<p>To inspect this new dataset within the Source window, simply pass <code>covid_data_economic_avg</code> to the <code>View</code> function.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="tutorial.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Views contents of &quot;covid_data_economic_avg&quot; dataset in R Studio data viewer</span></span>
<span id="cb35-2"><a href="tutorial.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_data_economic_avg)</span></code></pre></div>
<p>We should see something that looks like this:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-42"></span>
<img src="images/mean_economic.png" alt="Screenshot that shows contents of covid_data_economic_avg object in R Studio's data viewer; the object is a two-column dataset with one column containing 3-Digit ISO codes and the other containing the country level average of the Covid economic index; the column containing the country-level average is named mean_economic; the dataset in the data viewer is highlighted by a red rectangle" width="100%" />
<p class="caption">
Figure 4.8: Dataset of Country-Level Averages for ‘Economic_Measures’ Index
</p>
</div>
</div>
<div id="calculate-summary-statistics" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Calculate Summary Statistics</h3>
<p>Now that we have a new dataset (<code>covid_data_economic_avg</code>) containing the country-level average of the “Economic_Measures” index, it can be useful to get a sense of how this data (which is the data we’d like to map) is distributed. We can easily do this by using the <code>summary</code> function, which returns a table of summary statistics for a specified variable. The following code produces summary statistics for the “mean_economic” variable contained in <code>covid_data_economic_average</code> (which is referred to as <code>covid_data_economic$mean_economic</code>):</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="tutorial.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Produces table of summary statistics for &quot;mean_economic&quot; variable contained in &quot;covid_data_economic&quot; dataset</span></span>
<span id="cb36-2"><a href="tutorial.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(covid_data_economic_avg<span class="sc">$</span>mean_economic)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
 0.0000  0.2787  0.3930  0.3853  0.5074  0.7236      30 </code></pre>
</div>
</div>
<div id="join-datasets" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Join Datasets</h2>
<p>We’re almost ready to map our data. But before doing that, we will have to join the <code>covid_data_economic_avg</code> object we just created to <code>country_boundaries</code> (i.e. the spatial dataset of country boundaries discussed earlier). In other words, before we can map our variable of interest on a world map, we must bring this variable into the spatially explicit <code>country_boundaries</code> dataset.</p>
<p>The task of joining, or “merging” datasets is a very common procedure when working with social science data (or any data for that matter), since data is often held in many different locations, and must typically be brought together into a common dataset before it can be analyzed. That is essentially what we’re doing here.</p>
<p>How do we join different datasets together? Associating two datasets into one larger dataset that combines information from both requires the datasets to share a common field; this common field can be used to essentially “glue” the datasets together. The International Organization for Standardization provides 3-digit country codes for each of the world’s countries that can be used to uniquely identify countries when working with country-level data. Both our spatial dataset (<code>country_boundaries</code>), and our dataset containing information on the “Economic_Measures” index averages (<code>covid_data_economic_avg</code>), contain fields with these standardized 3-digit ISO codes (this field is labelled “iso_a3” in the spatial dataset, and “iso” in the dataset containing the “Economic_Measures” average). We will therefore use the fields containing these 3-digit country codes to join <code>covid_data_economic_avg</code> to <code>country_boundaries</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="tutorial.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join dataset with country-level means for the &quot;Economic_Measures&quot; index (i.e. &quot;covid_data_economic&quot;) to spatial dataset of world boundaries  (i.e. &quot;country_boundaries&quot;), based on common 3-Digit ISO Codes; then, assign this dataset to an object named &quot;covid_economic_spatial_dataset&quot;</span></span>
<span id="cb38-2"><a href="tutorial.html#cb38-2" aria-hidden="true" tabindex="-1"></a>covid_economic_spatial_dataset<span class="ot">&lt;-</span><span class="fu">full_join</span>(country_boundaries, covid_data_economic_avg, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;iso_a3&quot;</span><span class="ot">=</span><span class="st">&quot;iso&quot;</span>))</span></code></pre></div>
<p>In the code above, we use the <code>full_join</code> function to join <code>covid_data_economic_avg</code> to <code>country_boundaries</code>. The <code>full_join</code> function keeps all rows (i.e. observations) from both datasets, even if one dataset has observations that another one does not (and vice-versa). For more information on different join options, explore the documentation by inspecting the function’s documentation (<code>?full_join</code>).</p>
<ul>
<li>The first argument to the <code>full_join</code> function is <code>country_boundaries</code>, which is of course our spatial dataset.</li>
<li>The second argument, <code>covid_data_economic_avg</code> is the tabular dataset containing information on country_level averages for the Covid economic intervention index (i.e. the data we ultimately want to map).<a href="conclusion.html#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></li>
<li>The third argument specifies the join fields, i.e. the fields within the datasets that contain the common variable that can be used to correlate the records in the two different datasets and weld them together. In our case, the join variable is of course the 3-digit ISO country code. The argument that reads <code>by=c("iso_a3"="iso")</code> indicates that we want to join the datasets based on the set of country identifiers given by the 3-digit ISO codes; because the name of the column containing the 3-digit codes is different in the two datasets, the expression in the parentheses <code>"iso_a3"="iso"</code> simply indicates that the column named “iso_a3” (in the spatial dataset) and the column named (iso) in the tabular dataset are equivalent to each other, and are to be used as the join fields. If they didn’t have different names–for example, if the ISO codes were in a column named “iso” in <em>both</em> datasets–we could simply have written <code>by=iso</code> to specify the join column.</li>
<li>Finally, we take our newly created dataset, which adds the data we want to map our original spatial dataset (<code>country_boundaries</code>), and assign this value to a new object, named <code>covid_economic_spatial_dataset</code>.</li>
</ul>
<p>We can translate the code in the previous code block as follows: “Join <code>covid_data_economic_avg</code> to <code>country_boundaries</code> using the fields with 3-digit country ISO codes as the join fields (the column with ISO information in the spatial dataset is named ‘iso_a3’ while the column with ISO information in the tabular dataset is ‘iso’). Finally, assign the product of this join operation to a new object called <code>covid_economic_spatial_dataset</code>”</p>
<p>Before proceeding, let’s take a quick look at our newly created joined dataset. To make it easy to inspect, we can move up the variables we’re interested in (country name, the “mean_economic” variable, and the geometry information that makes the data spatial in nature) up to the front of the dataset:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="tutorial.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bring the &quot;name&quot;, &quot;mean_economic&quot;, and &quot;geometry&quot; fields/columns in &quot;covid_economic_spatial_dataset&quot; to the front of the dataset</span></span>
<span id="cb39-2"><a href="tutorial.html#cb39-2" aria-hidden="true" tabindex="-1"></a>covid_economic_spatial_dataset<span class="ot">&lt;-</span>covid_economic_spatial_dataset <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(name, mean_economic, geometry)</span></code></pre></div>
<p>After moving these fields by using the <code>relocate</code> function with the relevant fields as arguments, pass <code>worldmap_covid_data_economic</code>, whose variables have now been relocated, to the familiar <code>View</code> function:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="tutorial.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the contents of the &quot;covid_economic_spatial_dataset&quot; in the R Studio data viewer</span></span>
<span id="cb40-2"><a href="tutorial.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_economic_spatial_dataset)</span></code></pre></div>
<p>The dataset that opens up in your Source window should look something like this:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-47"></span>
<img src="images/joineddataset.png" alt="Screen shot with joined dataset displayed in R Studio data viewer; the first three columns are highlighted with a red rectangle. The first column contains country names, the second column contains the country-level average of the covid-economic index, and the third column contains geometry information that can be used to render countries as polygons using mapping tools" width="100%" />
<p class="caption">
Figure 4.9: Spatial Dataset With Covid-19 Economic Index Data
</p>
</div>
<p>Note that we now have a spatial dataset of country boundaries (as indicated by the “name” and “geometry” fields), with the data we want to map (the mean, for each country, of the Covid-19 Economic intervention index during the period under consideration) now included as a column within an expanded spatial dataset.</p>
</div>
<div id="make-a-print-map" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Make a Print Map</h2>
<p>We’re finally ready to represent our ICPSR data on a map! To do so, we’ll use the <em>tmap</em> package, which we already used above to view a rendered version of our spatial dataset of country boundaries. Now, we’ll take it a step further, and actually represent our data on the map features (i.e. the countries on the world map).</p>
<div id="make-a-preliminary-map" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Make a Preliminary Map</h3>
<p>Recall that as with with virtually anything else in R, we can assign maps created with the <em>tmap</em> package to objects, which makes it easy to subsquently reference our maps and customize them as needed. Below, we’ll create a rough draft of a map and assign it to an object named <code>covid_economic_map</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="tutorial.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates map based on the data contained within the &quot;mean_economic&quot; field of &quot;covid_economic&quot;spatial_dataset&quot;, and assigns this map to a new object called &quot;covid_economic_map&quot;</span></span>
<span id="cb41-2"><a href="tutorial.html#cb41-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(covid_economic_spatial_dataset)<span class="sc">+</span></span>
<span id="cb41-3"><a href="tutorial.html#cb41-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, </span>
<span id="cb41-4"><a href="tutorial.html#cb41-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">n=</span><span class="dv">8</span>, </span>
<span id="cb41-5"><a href="tutorial.html#cb41-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, </span>
<span id="cb41-6"><a href="tutorial.html#cb41-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>)</span></code></pre></div>
<p>Above, in the expression that is to the right of the assignment operator, we first use <em>tmap’s</em> <code>tm_shape</code> function to specify the spatial dataset whose features we’d like to display. Within <em>tmap</em>, chaining together functions requires a <code>+</code> sign, so we add a <code>+</code> before moving to another function on the next line. This is the <code>tm_polygons</code> function, which we use because our spatial dataset of country boundaries represents those boundaries as polygons. Previously, we did not specify arguments to the <code>tm_polygons</code> function, but this function can take a variety of arguments that can help us to customize our map’s appearance; we’ll introduce a few more arguments below, but recall that if we want to see the full range of possible arguments, they are presented in the function’s documentation (<code>?tm_polygons</code>).</p>
<p>Now, let’s consider the arguments that were passed to the <code>tm_polygons</code> function in the code above:</p>
<ul>
<li><code>col="mean_economic"</code> specifies the name of the column in the spatial dataset (which has been specified as an argument to the <code>tm_shape</code> function) that contains the data we’d like to map. Recall from the previous section that the name of this column is “mean_economic.”</li>
<li><code>n=8</code> specifies that we want the data to be partitioned into 8 bins</li>
<li><code>style="jenks"</code> indicates that we want to set break points in the data distribution using the Jenks Natural Breaks Classification; to see other options for partitioning your data, see the function’s documentation. For more information on the Jenks Natural Breaks Classification, as well as other data partition algorithms, see <a href="https://pro.arcgis.com/en/pro-app/2.7/help/mapping/layer-properties/data-classification-methods.htm">here</a>.</li>
<li><code>palette="BuGn"</code> specifies the color scheme that we want to use to represent the data. Check out this extremely useful <a href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf">guide</a> on colors and palettes in R (including information on relevant color codes). “BuGn” refers to a blue-green color gradient, which we will use to represent country-level variation in the Covid economic index.</li>
</ul>
<p>To see what the map looks like, simply print <code>covid_economic_map</code> and run it in the script:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="tutorial.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display contents of &quot;covid_economic_map&quot;</span></span>
<span id="cb42-2"><a href="tutorial.html#cb42-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-49-1.png" title="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is on the top right of the map superimposed over the Asia pacific, with some countries obscured by the legend. The legend is vertically oriented, and presents 8 discrete class breaks in the data. The map is bounded by a map frame that is drawn around it" alt="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is on the top right of the map superimposed over the Asia pacific, with some countries obscured by the legend. The legend is vertically oriented, and presents 8 discrete class breaks in the data. The map is bounded by a map frame that is drawn around it" width="672" /></p>
<p>As in Section 4.1.2 above, we can see the map in the “Plots” tab of the bottom-right window, and can open up a larger window by clicking the “Zoom” button right below the “Plots” tab.</p>
<p>Of course, the map we’ve just created needs a bit of work (most noticeably, the legend needs to be moved to a less distracting location), but after all of the previous work to set up our data, hopefully it feels exciting to finally see our tabular data transformed into a map!</p>
<p>Before we work on the legend, let’s see how to change certain features of the map using arguments to the <code>tm_polygons</code> function that we’ve already discussed. For instance, let’s say we want a Yellow to Red palette (“YlOrRd”; again, remember you can look up these codes at the color guide linked above), only five intervals for the data, and want the data to be equally partitioned across intervals (rather than by using the Jenks algorithm). We’ll assign this modified map to a new object, titled <code>covid_economic_map_alternative</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="tutorial.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modifies the appearance of &quot;covid_economic_map&quot; and assigns this modified map to a new object named &quot;covid_economic_map_alternative&quot;</span></span>
<span id="cb43-2"><a href="tutorial.html#cb43-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map_alternative<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(covid_economic_spatial_dataset)<span class="sc">+</span></span>
<span id="cb43-3"><a href="tutorial.html#cb43-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, </span>
<span id="cb43-4"><a href="tutorial.html#cb43-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">n=</span><span class="dv">5</span>, </span>
<span id="cb43-5"><a href="tutorial.html#cb43-5" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">style=</span><span class="st">&quot;equal&quot;</span>,</span>
<span id="cb43-6"><a href="tutorial.html#cb43-6" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">palette=</span><span class="st">&quot;YlOrRd&quot;</span>)</span></code></pre></div>
<p>Let’s display this map and view its appearance; notice the change in color, the fewer number of classes, and the equal intervals in the legend:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="tutorial.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Displays contents of &quot;covid_economic_map_alternative&quot;</span></span>
<span id="cb44-2"><a href="tutorial.html#cb44-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map_alternative</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/a-1.png" title="Choropleth world map showing variation in country-level average of covid economic intervention index; yellow to dark red color scheme ranging from lighter shades of yellow to represent lower values of the index and darker shades of red to represent higher values; countries without data are filled in with gray The map legend is on the top right of the map superimposed over the Asia pacific, with some countries obscured by the legend. The legend is vertically oriented, and presents 5 discrete class breaks in the data. The map is bounded by a map frame that is drawn around it" alt="Choropleth world map showing variation in country-level average of covid economic intervention index; yellow to dark red color scheme ranging from lighter shades of yellow to represent lower values of the index and darker shades of red to represent higher values; countries without data are filled in with gray The map legend is on the top right of the map superimposed over the Asia pacific, with some countries obscured by the legend. The legend is vertically oriented, and presents 5 discrete class breaks in the data. The map is bounded by a map frame that is drawn around it" width="672" /></p>
<p>Also, that depending on our preferences, we can easily remove the map frame, by using the “Frame” argument within the <code>tm_layout</code> function:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="tutorial.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removes frame from &quot;covid_economic_map_alternative&quot; map</span></span>
<span id="cb45-2"><a href="tutorial.html#cb45-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map_alternative<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(covid_economic_spatial_dataset)<span class="sc">+</span></span>
<span id="cb45-3"><a href="tutorial.html#cb45-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, </span>
<span id="cb45-4"><a href="tutorial.html#cb45-4" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">n=</span><span class="dv">5</span>, </span>
<span id="cb45-5"><a href="tutorial.html#cb45-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">style=</span><span class="st">&quot;equal&quot;</span>, </span>
<span id="cb45-6"><a href="tutorial.html#cb45-6" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">palette=</span><span class="st">&quot;YlOrRd&quot;</span>)<span class="sc">+</span></span>
<span id="cb45-7"><a href="tutorial.html#cb45-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>)</span>
<span id="cb45-8"><a href="tutorial.html#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="tutorial.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Displays amended contents of &quot;covid_economic_map_alternative&quot; object (i.e. map without a frame)</span></span>
<span id="cb45-10"><a href="tutorial.html#cb45-10" aria-hidden="true" tabindex="-1"></a>covid_economic_map_alternative</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/b-1.png" title="Choropleth world map showing variation in country-level average of covid economic intervention index; yellow to dark red color scheme ranging from lighter shades of yellow to represent lower values of the index and darker shades of red to represent higher values; countries without data are filled in with gray The map legend is on the top right of the map superimposed over the Asia pacific, with some countries obscured by the legend. The legend is vertically oriented, and presents 5 discrete class breaks in the data. The map is not bounded by a map frame that is drawn around it" alt="Choropleth world map showing variation in country-level average of covid economic intervention index; yellow to dark red color scheme ranging from lighter shades of yellow to represent lower values of the index and darker shades of red to represent higher values; countries without data are filled in with gray The map legend is on the top right of the map superimposed over the Asia pacific, with some countries obscured by the legend. The legend is vertically oriented, and presents 5 discrete class breaks in the data. The map is not bounded by a map frame that is drawn around it" width="672" /></p>
</div>
<div id="customize-legend" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Customize Legend</h3>
<p>The biggest issue with the rough drafts of our map from the previous subsection is the position of the legend. Let’s go back to the first map we made (<code>covid_economic_map</code>), and simply switch its legend position, by specifying <code>position=c("left","bottom")</code> withing the <code>tm_legend</code> function:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="tutorial.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shifts legend position using the &quot;tm_legend&quot; function, and assigns amended map to &quot;covid_economic_map&quot;</span></span>
<span id="cb46-2"><a href="tutorial.html#cb46-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(covid_economic_spatial_dataset)<span class="sc">+</span></span>
<span id="cb46-3"><a href="tutorial.html#cb46-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, </span>
<span id="cb46-4"><a href="tutorial.html#cb46-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">n=</span><span class="dv">8</span>, </span>
<span id="cb46-5"><a href="tutorial.html#cb46-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, </span>
<span id="cb46-6"><a href="tutorial.html#cb46-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>)<span class="sc">+</span></span>
<span id="cb46-7"><a href="tutorial.html#cb46-7" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb46-8"><a href="tutorial.html#cb46-8" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_legend</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb46-9"><a href="tutorial.html#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="tutorial.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Views amended contents of  &quot;covid_economic_map&quot;</span></span>
<span id="cb46-11"><a href="tutorial.html#cb46-11" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/c-1.png" title="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is on the bottom-left of the map, positioned to the left of South America. The legend is vertically oriented, and displays 8 discrete intervals for the data. There is no map frame drawn around the map." alt="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is on the bottom-left of the map, positioned to the left of South America. The legend is vertically oriented, and displays 8 discrete intervals for the data. There is no map frame drawn around the map." width="672" /></p>
<p>Currently, our legend is discrete, but we may want to try using a continuous legend to better match the continuous nature of the index (for more on discrete breaks vs continuous gradients, see <a href="https://developers.arcgis.com/javascript/latest/visualization/best-practices/classed-vs-continuous/">here</a>. We can do this by setting <code>style="cont</code> within the <code>tm_polygons</code> function:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="tutorial.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changes &quot;style&quot; argument parameter within &quot;tm_polygons&quot; function to &quot;cont&quot; to make continuous legend and assigns amended map to &quot;covid_economic_map&quot; (thereby overwriting the previous contents of &quot;covid_economic_map)</span></span>
<span id="cb47-2"><a href="tutorial.html#cb47-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(covid_economic_spatial_dataset)<span class="sc">+</span></span>
<span id="cb47-3"><a href="tutorial.html#cb47-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, </span>
<span id="cb47-4"><a href="tutorial.html#cb47-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">style=</span><span class="st">&quot;cont&quot;</span>, </span>
<span id="cb47-5"><a href="tutorial.html#cb47-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>)<span class="sc">+</span></span>
<span id="cb47-6"><a href="tutorial.html#cb47-6" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb47-7"><a href="tutorial.html#cb47-7" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_legend</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb47-8"><a href="tutorial.html#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="tutorial.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display amended map</span></span>
<span id="cb47-10"><a href="tutorial.html#cb47-10" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/d-1.png" title="Choropleth world map showing variation in country-level average of covid economic intervention index; green color gradient ranging from lighter shades of green (at the top of the legend bar) to represent lower values of the index and darker shades of green (at the bottom of the legend bar) to represent higher values. Countries without data are filled in with gray The map legend is a vertical bar that displays values using a continuous gradient, with the default-chosen numbers 0, 0.2, 0.4., and 0.6 arrayed next to the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map next to South America, with the legend title positioned over the vertical color gradient. There is no map frame surrounding the map" alt="Choropleth world map showing variation in country-level average of covid economic intervention index; green color gradient ranging from lighter shades of green (at the top of the legend bar) to represent lower values of the index and darker shades of green (at the bottom of the legend bar) to represent higher values. Countries without data are filled in with gray The map legend is a vertical bar that displays values using a continuous gradient, with the default-chosen numbers 0, 0.2, 0.4., and 0.6 arrayed next to the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map next to South America, with the legend title positioned over the vertical color gradient. There is no map frame surrounding the map" width="672" /></p>
<p>Let’s explore some additional ways to customize our legend:</p>
<ul>
<li>Notice that the legend has a “Missing” category, to indicate countries for which we don’t have data on the Covid-19 economic index. Instead of labelling it “Missing” we’ll’ label it as “No Data”.</li>
<li>Let’s give the legend a title that describes the data: “Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)”.</li>
<li>It’s possible to experiment with different legend orientations. To see this, let’s flip the legend’s orientation, turning it into a horizontal rather than vertical bar.</li>
<li>It’s also possible to specify our own intervals for the legend; we’ll set our legend breaks at 0, 0.25, 0.5, and 0.72.</li>
<li>We’ll customize the size of our legend, as well as the legend’s text.</li>
<li>We’ll alter the location of our legend, placing it outside the map’s bounding box (as defined by the now-invisible map frame)</li>
</ul>
<p>The following code incorporates these changes into the previous map:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="tutorial.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adds additional customizations to legend and assigns amended map to &quot;covid_economic_map&quot; (thereby overwriting the object&#39;s previous contents)</span></span>
<span id="cb48-2"><a href="tutorial.html#cb48-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(covid_economic_spatial_dataset)<span class="sc">+</span></span>
<span id="cb48-3"><a href="tutorial.html#cb48-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, </span>
<span id="cb48-4"><a href="tutorial.html#cb48-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">style=</span><span class="st">&quot;cont&quot;</span>, </span>
<span id="cb48-5"><a href="tutorial.html#cb48-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>, </span>
<span id="cb48-6"><a href="tutorial.html#cb48-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">textNA=</span><span class="st">&quot;No Data&quot;</span>, </span>
<span id="cb48-7"><a href="tutorial.html#cb48-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title=</span><span class="st">&quot;Mean of Covid</span><span class="sc">\n</span><span class="st">Economic</span><span class="sc">\n</span><span class="st">Intervention Index</span><span class="sc">\n</span><span class="st">(1/1/2020 to</span><span class="sc">\n</span><span class="st"> 10/1/2020)&quot;</span>, </span>
<span id="cb48-8"><a href="tutorial.html#cb48-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">legend.is.portrait=</span><span class="cn">FALSE</span>,</span>
<span id="cb48-9"><a href="tutorial.html#cb48-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>, <span class="fl">0.72</span>))<span class="sc">+</span></span>
<span id="cb48-10"><a href="tutorial.html#cb48-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_layout</span>(<span class="at">legend.title.size=</span><span class="fl">0.7</span>, </span>
<span id="cb48-11"><a href="tutorial.html#cb48-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.title.fontface=</span><span class="dv">2</span>,</span>
<span id="cb48-12"><a href="tutorial.html#cb48-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.outside=</span><span class="cn">TRUE</span>,</span>
<span id="cb48-13"><a href="tutorial.html#cb48-13" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.outside.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>), </span>
<span id="cb48-14"><a href="tutorial.html#cb48-14" aria-hidden="true" tabindex="-1"></a>                                <span class="at">frame=</span><span class="cn">FALSE</span>, </span>
<span id="cb48-15"><a href="tutorial.html#cb48-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.text.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb48-16"><a href="tutorial.html#cb48-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.width =</span> <span class="fl">0.35</span>)</span>
<span id="cb48-17"><a href="tutorial.html#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="tutorial.html#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Displays updated contents of &quot;covid_economic_map&quot;</span></span>
<span id="cb48-19"><a href="tutorial.html#cb48-19" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/e-1.png" title="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is a horizontal bar that displays values using a continuous color gradient with custom-chosen numbers arrayed below the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map below and to the left of South America and is titled 'Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)'; the legend title is in bold and placed over the horizontal legend bar. There is no map frame surrounding the map." alt="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is a horizontal bar that displays values using a continuous color gradient with custom-chosen numbers arrayed below the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map below and to the left of South America and is titled 'Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)'; the legend title is in bold and placed over the horizontal legend bar. There is no map frame surrounding the map." width="672" /></p>
<p>Let’s unpack this code; for the sake of completeness, we’ll go over all of the functions and arguments, rather than just the code that implements the changes mentioned above.</p>
<p>Above, to the right of the assignment operator, we have:</p>
<ul>
<li><code>tm_shape(covid_economic_spatial_dataset)</code> specifies the spatial dataset that contains the information we want to map.</li>
<li>The <code>tm_polygons</code> function takes many arguments here:
<ul>
<li><code>col="mean_economic"</code> specifies the name of the column in <code>covid_economic_spatial_dataset</code> that contains the data we wish to map.</li>
<li><code>style=cont</code> indicates that we want a continuous legend</li>
<li><code>palette="BuGn"</code> specifies the color scheme we wish to use to represent variation in the data.</li>
<li><code>textNA="No Data</code> indicates that we want data coded as “NA” to be labeled “No Data” in our legend; the default label is “Missing”</li>
<li><code>title="Mean of Covid\nEconomic\nIntervention Index\n(1/1/2020 to\n 10/1/2020)"</code> specifies the title of the legend. The <code>\n</code> notation is used to indicate line breaks. If these are not included, the legend title would not contain line breaks, and would be one line. .</li>
<li><code>legend.is.portrait=FALSE</code> flips the legend, making its orientation horizontal rather than vertical</li>
<li><code>breaks=c(0,0.25,0.5,0.72)</code> specifies our custom breaks (for values of the Covid economic index) in the legend.</li>
</ul></li>
<li>The <code>tm_layout</code> function also takes many arguments:
<ul>
<li><code>legend.title.size=0.7</code> sets the size of the text in the legend’s title</li>
<li><code>legend.title.fontface=2</code> makes the legend title bold.</li>
<li><code>legend.outside=TRUE</code> specifies that the legend is to be situated outside the (invisible) map frame; this prevents the legend from blocking out portions of the map itself</li>
<li><code>legend.outside.position = c("bottom")</code> positions the legend below the southern border of the (invisible) map frame</li>
<li><code>frame=FALSE</code> makes the map frame invisible, so that we don’t see a border surrounding the countries</li>
<li><code>legend.text.size=0.5</code> specifies the size of the legend text that is not part of the legend title</li>
<li><code>legend.width=0.35</code> specifies the width of the legend</li>
</ul></li>
</ul>
<p>The best way to get a sense of how all of these various arguments work is to change the values of the arguments and then inspect their effect on the map’s appearance. You will have an opportunity to try this in Practice Exercise 1 below (Section 5.1)</p>
</div>
<div id="add-map-title-and-credits" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Add Map Title and Credits</h3>
<p>One useful thing to keep in mind is that when adding new elements to our map, it’s not necessary to retype all of our code; thus far, that is what we’ve been doing, but it’s also possible to simply append changes to an existing object. Below, to the right of the assignment operator, we first print the name of the object we want to modify (i.e. <code>covid_economic_map</code>) and then type a “+” sign; then, we can modify the object as desired through the use of relevant functions, and then save those changes by assigning the map back to <code>covid_economic_map</code>. In particular, we want to add and customize a map title (which we will do by passing a few additional arguments to the now-familiar <code>tm_layout</code> function), as well as add and customize a “Map Credits” section, which will include some basic map metadata.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="tutorial.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adds map credits and title to existing &quot;covid_economic_map&quot; object, and then assigns this amended map back to &quot;covid_economic_map&quot; (thereby overwriting the map that was previously assigned to this object)</span></span>
<span id="cb49-2"><a href="tutorial.html#cb49-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span>covid_economic_map<span class="sc">+</span></span>
<span id="cb49-3"><a href="tutorial.html#cb49-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">&quot;Scope of National Economic Support Measures</span><span class="sc">\n</span><span class="st">in Response to the Covid-19 Pandemic&quot;</span>, </span>
<span id="cb49-4"><a href="tutorial.html#cb49-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">main.title.position=</span><span class="st">&quot;center&quot;</span>,</span>
<span id="cb49-5"><a href="tutorial.html#cb49-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">main.title.size=</span><span class="dv">1</span>, </span>
<span id="cb49-6"><a href="tutorial.html#cb49-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">inner.margins=</span><span class="fu">c</span>(<span class="fl">0.06</span>,<span class="fl">0.10</span>,<span class="fl">0.10</span>,<span class="fl">0.08</span>), </span>
<span id="cb49-7"><a href="tutorial.html#cb49-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">attr.outside =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb49-8"><a href="tutorial.html#cb49-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">tm_credits</span>(<span class="st">&quot;Map Author: Aditya Ranganath</span><span class="sc">\n</span><span class="st">Dataset Author: Simon Porcher</span><span class="sc">\n</span><span class="st">CRS: WGS1984</span><span class="sc">\n</span><span class="st">Source: ICPSR&quot;</span>, </span>
<span id="cb49-9"><a href="tutorial.html#cb49-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position=</span><span class="fu">c</span>(<span class="fl">0.78</span>,<span class="dv">0</span>), </span>
<span id="cb49-10"><a href="tutorial.html#cb49-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="fl">0.38</span>)</span>
<span id="cb49-11"><a href="tutorial.html#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="tutorial.html#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the amended &quot;covid_economic_map&quot; object</span></span>
<span id="cb49-13"><a href="tutorial.html#cb49-13" aria-hidden="true" tabindex="-1"></a>covid_economic_map </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/f-1.png" title="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is a horizontal bar that displays values using a continuous color gradient with custom-chosen numbers arrayed below the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map below and to the left of South America and is titled 'Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)'; the legend title is in bold and placed over the horizontal legend bar. There is no map frame surrounding the map. The map's title is 'Scope of National Economic Support Measures in Response to the Covid-19 Pandemic', which is split into two lines and centered at the top of the map above the northern-most countries. The map credits are split across four lines, and printed on the bottom-right of the map below Australia and New Zealand." alt="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is a horizontal bar that displays values using a continuous color gradient with custom-chosen numbers arrayed below the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map below and to the left of South America and is titled 'Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)'; the legend title is in bold and placed over the horizontal legend bar. There is no map frame surrounding the map. The map's title is 'Scope of National Economic Support Measures in Response to the Covid-19 Pandemic', which is split into two lines and centered at the top of the map above the northern-most countries. The map credits are split across four lines, and printed on the bottom-right of the map below Australia and New Zealand." width="672" /></p>
<p>Let’s consider the new arguments passed through the <code>tm_layout</code> and <code>tm_credits</code> function:</p>
<ul>
<li><code>tm_layout</code>
<ul>
<li><code>main.title="Scope of National Economic Support Measures\nin Response to the Covid-19 Pandemic"</code> specifies the title for the map as a whole. As before <code>\n</code> specifies line breaks.</li>
<li><code>main.title.position="center"</code> specifies the justification of the title</li>
<li><code>main.title.size=1</code> specifies the font size of the title</li>
<li><code>inner.margins=c(0.06,0.10,0.10,0.08)</code> establishes the size of the margins within the map frame. Its most noticeable impact in this context is to regulate the whitespace between the title and the map features.</li>
<li><code>attr.outside = TRUE</code>, in this context, places the map credits (one of the map’s attributes), outside the map frame</li>
</ul></li>
<li>The <code>tm_credits</code> function is a function used to choose the content and appearance of the map’s credits section.
<ul>
<li><code>"Map Author: Aditya Ranganath\nDataset Author: Simon Porcher\nCRS: WGS1984\nSource: ICPSR</code> is the text of the credits section; as before, <code>\n</code> specifies line breaks</li>
<li><code>position=c(0.78,0)</code> specifies the location of the credits</li>
<li><code>size=0.38</code> specifies the size of the text in the credits section</li>
</ul></li>
</ul>
<p>It’s worth emphasizing that when working on your these maps, a lot of trial-and-error is usually required in order to determine the values for the various function arguments that will yield a map with the desired appearance. In addition, there are a lot of <em>tmap</em> functions and arguments that we haven’t covered; be sure to explore all the possibilities by exploring <em>tmap’s</em> documentation (<code>?tmap</code>)</p>
</div>
<div id="final-map-code" class="section level3" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Final Map Code</h3>
<p>For convenience, here’s all of the code that we used to construct the map we arrived at in the previous section, along with comments summarizing what each line is doing:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="tutorial.html#cb50-1" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span>                      <span class="co"># assigns map to object named &quot;covid_econonmic_map&quot;</span></span>
<span id="cb50-2"><a href="tutorial.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(covid_economic_spatial_dataset)<span class="sc">+</span> <span class="co"># Specifies Spatial Dataset</span></span>
<span id="cb50-3"><a href="tutorial.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>,      <span class="co"># Specifies column we want to map</span></span>
<span id="cb50-4"><a href="tutorial.html#cb50-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;cont&quot;</span>,             <span class="co"># Specifies continuous legend</span></span>
<span id="cb50-5"><a href="tutorial.html#cb50-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>,           <span class="co"># Specifies color palette/scheme to represent data variation</span></span>
<span id="cb50-6"><a href="tutorial.html#cb50-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">textNA=</span><span class="st">&quot;No Data&quot;</span>,         <span class="co"># Codes &quot;NA&quot; values as &quot;No Data&quot; in the legend</span></span>
<span id="cb50-7"><a href="tutorial.html#cb50-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">title=</span><span class="st">&quot;Mean of Covid</span><span class="sc">\n</span><span class="st">Economic</span><span class="sc">\n</span><span class="st">Intervention Index</span><span class="sc">\n</span><span class="st">(1/1/2020 to</span><span class="sc">\n</span><span class="st"> 10/1/2020)&quot;</span>, <span class="co"># Sets legend title</span></span>
<span id="cb50-8"><a href="tutorial.html#cb50-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.is.portrait=</span><span class="cn">FALSE</span>, <span class="co"># Makes legend horizontal</span></span>
<span id="cb50-9"><a href="tutorial.html#cb50-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>, <span class="fl">0.72</span>))<span class="sc">+</span> <span class="co"># Sets legend breaks</span></span>
<span id="cb50-10"><a href="tutorial.html#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.title.size=</span><span class="fl">0.7</span>,      <span class="co"># Sets legend title size</span></span>
<span id="cb50-11"><a href="tutorial.html#cb50-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.fontface=</span><span class="dv">2</span>,    <span class="co"># Makes legend bold</span></span>
<span id="cb50-12"><a href="tutorial.html#cb50-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside=</span><span class="cn">TRUE</span>,        <span class="co"># Puts legend outside map frame</span></span>
<span id="cb50-13"><a href="tutorial.html#cb50-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position=</span><span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>), <span class="co"># Puts legend below map frame</span></span>
<span id="cb50-14"><a href="tutorial.html#cb50-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame=</span><span class="cn">FALSE</span>,                <span class="co"># Makes map frame invisible                         </span></span>
<span id="cb50-15"><a href="tutorial.html#cb50-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.5</span>,     <span class="co"># Sets size of legend tex</span></span>
<span id="cb50-16"><a href="tutorial.html#cb50-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width=</span><span class="fl">0.35</span>,          <span class="co"># Sets legend width</span></span>
<span id="cb50-17"><a href="tutorial.html#cb50-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title=</span><span class="st">&quot;Scope of National Economic Support Measures</span><span class="sc">\n</span><span class="st">in Response to the Covid-19 Pandemic&quot;</span>, <span class="co"># Sets map title</span></span>
<span id="cb50-18"><a href="tutorial.html#cb50-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position=</span><span class="st">&quot;center&quot;</span>, <span class="co"># Specifies title justification</span></span>
<span id="cb50-19"><a href="tutorial.html#cb50-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,          <span class="co"># Specifies title font size</span></span>
<span id="cb50-20"><a href="tutorial.html#cb50-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">inner.margins=</span><span class="fu">c</span>(<span class="fl">0.06</span>,<span class="fl">0.10</span>,<span class="fl">0.10</span>,<span class="fl">0.08</span>), <span class="co"># Sets map margins with respect to frame</span></span>
<span id="cb50-21"><a href="tutorial.html#cb50-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">attr.outside =</span> <span class="cn">TRUE</span>)<span class="sc">+</span>       <span class="co"># Places map credits outside frame</span></span>
<span id="cb50-22"><a href="tutorial.html#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_credits</span>(<span class="st">&quot;Map Author: Aditya Ranganath</span><span class="sc">\n</span><span class="st">Dataset Author: Simon Porcher</span><span class="sc">\n</span><span class="st">CRS: WGS1984</span><span class="sc">\n</span><span class="st">Source: ICPSR&quot;</span>, <span class="co"># Sets text for map credits</span></span>
<span id="cb50-23"><a href="tutorial.html#cb50-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">position=</span><span class="fu">c</span>(<span class="fl">0.78</span>,<span class="dv">0</span>), <span class="co"># Specifies location of map credits</span></span>
<span id="cb50-24"><a href="tutorial.html#cb50-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">0.38</span>)          <span class="co"># Specifies font size of credits text</span></span>
<span id="cb50-25"><a href="tutorial.html#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="tutorial.html#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Displays &quot;covid_economic_map&quot; object</span></span>
<span id="cb50-27"><a href="tutorial.html#cb50-27" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/g-1.png" title="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is a horizontal bar that displays values using a continuous color gradient with custom-chosen numbers arrayed below the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map below and to the left of South America and is titled 'Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)'; the legend title is in bold and placed over the horizontal legend bar. There is no map frame surrounding the map. The map's title is 'Scope of National Economic Support Measures in Response to the Covid-19 Pandemic', which is split into two lines and centered at the top of the map above the northern-most countries. The map credits are split across four lines, and printed on the bottom-right of the map below Australia and New Zealand." alt="Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is a horizontal bar that displays values using a continuous color gradient with custom-chosen numbers arrayed below the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map below and to the left of South America and is titled 'Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)'; the legend title is in bold and placed over the horizontal legend bar. There is no map frame surrounding the map. The map's title is 'Scope of National Economic Support Measures in Response to the Covid-19 Pandemic', which is split into two lines and centered at the top of the map above the northern-most countries. The map credits are split across four lines, and printed on the bottom-right of the map below Australia and New Zealand." width="672" /></p>
</div>
</div>
<div id="export-map" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Export Map</h2>
<p>Once we’re done customizing our map, we can copy it to our clipboard (and paste it elsewhere), export it as an image file (i.e. png or jpeg), or export it as a PDF; we can either do this programatically using a built-in <em>tmap</em> function, or we can do it through the R Studio GUI.</p>
<div id="export-map-using-tmap" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Export Map Using <em>tmap</em></h3>
<p>To export maps programmatically, we can use the <code>tmap_save</code> function. The first argument to this function should be the name of map object we want to export (here, <code>covid_economic_map</code>); the second should be the file name, including the extension, of the file to which we want to save the map object. If, for example, we wanted to save a png file with the name “covid_economic_map_export”, this second argument would be “covid_economic_map_export.png”. This is all we need in order to export the map (which will be saved in our working directory), but the <code>tmap_save</code> function allows several other arguments that you can learn about by inspecting the function’s documentation (<code>?tmap_save</code>). The only other arguments we’ll use are the “width” and “height” arguments, which allow us to specify the dimensions of the exported map (in pixels). We’ll export a map with width of 1920 pixels, and a height of 1080 pixels.</p>
<p>The first code block below writes <code>covid_economic_map</code> as a png file (with dimensions of 1920 x 1080 pixels) to our working directory; the subsequent two blocks write the object as jpeg and PDF files, respectively.</p>
<p>PNG File</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="tutorial.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saves contents of &quot;covid_economic_map&quot; object as png file to working directory with resolution of 1920 by 1080 pixels</span></span>
<span id="cb51-2"><a href="tutorial.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_save</span>(covid_economic_map, <span class="st">&quot;covid_economic_map_export.png&quot;</span>, <span class="at">width=</span><span class="dv">1920</span>, <span class="at">height=</span><span class="dv">1080</span>)</span></code></pre></div>
<p>JPEG File</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="tutorial.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saves contents of &quot;covid_economic_map&quot; object as jpeg file to working directory with resolution of 1920 by 1080 pixels</span></span>
<span id="cb52-2"><a href="tutorial.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_save</span>(covid_economic_map, <span class="st">&quot;covid_map.jpeg&quot;</span>, <span class="at">width=</span><span class="dv">1920</span>, <span class="at">height=</span><span class="dv">1080</span>)</span></code></pre></div>
<p>PDF File</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="tutorial.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saves contents of &quot;covid_economic_map&quot; object as pdf file to working directory with resolution of 1920 by 1080 pixels</span></span>
<span id="cb53-2"><a href="tutorial.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_save</span>(covid_economic_map, <span class="st">&quot;covid_map.pdf&quot;</span>, <span class="at">width=</span><span class="dv">1920</span>, <span class="at">height=</span><span class="dv">1080</span>)</span></code></pre></div>
<p>Once we’ve exported the map to our working directly in the format we’d like, we can open up the file on our computer. The PNG file will look something like this:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53"></span>
<img src="images/covid_economic_map_export.png" alt="Screenshot of final covid_economic_map object as PNG image file that was exported from R Studio; appearance of the map is the same as the map created and described in Section 4.5.4" width="100%" />
<p class="caption">
Figure 4.10: Map Exported as Image File
</p>
</div>
</div>
<div id="export-map-through-gui" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Export Map Through GUI</h3>
<p>It’s also possible to export our map in the desired file format by using the “Export” menu bar within the “Plots” tab on the bottom-right of our R Studio interface. Click the “Export” button, and select one of the three options; from there, things should be self-explantory.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-54"></span>
<img src="images/exportalt.png" alt="Screenshot demonstrating how to export map as image file using R Studio's GUI; red rectangle around the export button located in the bottom-right of the R Studio interface" width="100%" />
<p class="caption">
Figure 4.11: Export Map Using R Studio GUI
</p>
</div>
</div>
</div>
<div id="summary" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Summary</h2>
<p>After working through the tutorial, it can be useful to see the essential steps required to generate our final map a in a self-contained script that summarize all of the steps we took above. Section 4.8.1. presents a summary version of our map script. Note that the summary script below presupposes that we are in the correct working directory (i.e. the working directory which contains the ICPSR data we downloaded as an Excel file; see Section 3.6), and that all the required libraries are loaded (see Section 3.5)</p>
<div id="print-map-summary-script" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Print Map Summary Script</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="tutorial.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imports &quot;Dataset&quot; sheet from ICPSR Excel file into R Studio, and assigns the dataset to an object called &quot;covid_data&quot;</span></span>
<span id="cb54-2"><a href="tutorial.html#cb54-2" aria-hidden="true" tabindex="-1"></a>covid_data<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;Gov_Responses2Covid19_last.xlsx&quot;</span>, <span class="at">sheet=</span><span class="st">&quot;Dataset&quot;</span>)</span>
<span id="cb54-3"><a href="tutorial.html#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="tutorial.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Brings spatial dataset of country boundaries into R environment using the rnaturalearth package and assigns it to object named &quot;country_boundaries&quot;</span></span>
<span id="cb54-5"><a href="tutorial.html#cb54-5" aria-hidden="true" tabindex="-1"></a>country_boundaries<span class="ot">&lt;-</span><span class="fu">ne_countries</span>(<span class="at">scale=</span><span class="st">&quot;medium&quot;</span>, <span class="at">returnclass=</span><span class="st">&quot;sf&quot;</span>)</span>
<span id="cb54-6"><a href="tutorial.html#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="tutorial.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Deletes Antarctica from &quot;country_boundaries&quot; object</span></span>
<span id="cb54-8"><a href="tutorial.html#cb54-8" aria-hidden="true" tabindex="-1"></a>country_boundaries<span class="ot">&lt;-</span>country_boundaries <span class="sc">%&gt;%</span> <span class="fu">filter</span>(iso_a3 <span class="sc">!=</span><span class="st">&quot;ATA&quot;</span>)</span>
<span id="cb54-9"><a href="tutorial.html#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="tutorial.html#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Selects &quot;iso&quot; and &quot;Economic_Measures&quot; variables from ICPSR Dataset, and assigns this new dataset to object named &quot;covid_data_economic&quot; </span></span>
<span id="cb54-11"><a href="tutorial.html#cb54-11" aria-hidden="true" tabindex="-1"></a>covid_data_economic<span class="ot">&lt;-</span>covid_data <span class="sc">%&gt;%</span> </span>
<span id="cb54-12"><a href="tutorial.html#cb54-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(iso, Economic_Measures) </span>
<span id="cb54-13"><a href="tutorial.html#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="tutorial.html#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Changes class of &quot;Economic_Measures&quot; field in &quot;covid_data_economic&quot; object from character to numeric</span></span>
<span id="cb54-15"><a href="tutorial.html#cb54-15" aria-hidden="true" tabindex="-1"></a>covid_data_economic<span class="sc">$</span>Economic_Measures<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(covid_data_economic<span class="sc">$</span>Economic_Measures)</span>
<span id="cb54-16"><a href="tutorial.html#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="tutorial.html#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates Country-Level Averages for &quot;Economic_Measures&quot; Index, and then assigns this dataset of country-level averages to a new object called &quot;covid_data_economic_avg&quot;. </span></span>
<span id="cb54-18"><a href="tutorial.html#cb54-18" aria-hidden="true" tabindex="-1"></a>covid_data_economic_avg<span class="ot">&lt;-</span>covid_data_economic <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(iso) <span class="sc">%&gt;%</span> </span>
<span id="cb54-19"><a href="tutorial.html#cb54-19" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">summarize</span>(<span class="at">mean_economic=</span><span class="fu">mean</span>(Economic_Measures, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb54-20"><a href="tutorial.html#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="tutorial.html#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Joins dataset containing information on country-level means for &quot;Economic_Measures&quot; index (in &quot;covid_data_economic&quot; object) to spatial dataset of world boundaries (in &quot;country_boundaries&quot; object), based on common 3-Digit ISO Codes and assigns the dataset that results from this join to &quot;covid_economic_spatial_dataset&quot;</span></span>
<span id="cb54-22"><a href="tutorial.html#cb54-22" aria-hidden="true" tabindex="-1"></a>covid_economic_spatial_dataset<span class="ot">&lt;-</span><span class="fu">full_join</span>(country_boundaries, covid_data_economic_avg, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;iso_a3&quot;</span><span class="ot">=</span><span class="st">&quot;iso&quot;</span>))</span>
<span id="cb54-23"><a href="tutorial.html#cb54-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-24"><a href="tutorial.html#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Make static map using data in &quot;covid_economic_spatial_dataset&quot; and assigns the map to object called &quot;covid_economic_map&quot;</span></span>
<span id="cb54-25"><a href="tutorial.html#cb54-25" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span>  </span>
<span id="cb54-26"><a href="tutorial.html#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(covid_economic_spatial_dataset)<span class="sc">+</span> <span class="co"># Specifies Spatial Dataset containing data we want to map</span></span>
<span id="cb54-27"><a href="tutorial.html#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>,      <span class="co"># Specifies column we want to map</span></span>
<span id="cb54-28"><a href="tutorial.html#cb54-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;cont&quot;</span>,             <span class="co"># Specifies continuous legend</span></span>
<span id="cb54-29"><a href="tutorial.html#cb54-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>,           <span class="co"># Specifies color palette/scheme to represent data variation</span></span>
<span id="cb54-30"><a href="tutorial.html#cb54-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">textNA=</span><span class="st">&quot;No Data&quot;</span>,         <span class="co"># Codes &quot;NA&quot; values as &quot;No Data&quot; in the legend</span></span>
<span id="cb54-31"><a href="tutorial.html#cb54-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">title=</span><span class="st">&quot;Mean of Covid</span><span class="sc">\n</span><span class="st">Economic</span><span class="sc">\n</span><span class="st">Intervention Index</span><span class="sc">\n</span><span class="st">(1/1/2020 to</span><span class="sc">\n</span><span class="st"> 10/1/2020)&quot;</span>, <span class="co"># Sets legend title</span></span>
<span id="cb54-32"><a href="tutorial.html#cb54-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.is.portrait=</span><span class="cn">FALSE</span>, <span class="co"># Makes legend horizontal</span></span>
<span id="cb54-33"><a href="tutorial.html#cb54-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>, <span class="fl">0.72</span>))<span class="sc">+</span> <span class="co"># Sets legend breaks</span></span>
<span id="cb54-34"><a href="tutorial.html#cb54-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.title.size=</span><span class="fl">0.7</span>,      <span class="co"># Sets legend title size</span></span>
<span id="cb54-35"><a href="tutorial.html#cb54-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.fontface=</span><span class="dv">2</span>,    <span class="co"># Makes legend bold</span></span>
<span id="cb54-36"><a href="tutorial.html#cb54-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside=</span><span class="cn">TRUE</span>,        <span class="co"># Puts legend outside map frame</span></span>
<span id="cb54-37"><a href="tutorial.html#cb54-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position=</span><span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>), <span class="co"># Puts legend below map frame</span></span>
<span id="cb54-38"><a href="tutorial.html#cb54-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame=</span><span class="cn">FALSE</span>,                <span class="co"># Makes map frame invisible                         </span></span>
<span id="cb54-39"><a href="tutorial.html#cb54-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.5</span>,     <span class="co"># Sets size of legend tex</span></span>
<span id="cb54-40"><a href="tutorial.html#cb54-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width=</span><span class="fl">0.35</span>,          <span class="co"># Sets legend width</span></span>
<span id="cb54-41"><a href="tutorial.html#cb54-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title=</span><span class="st">&quot;Scope of National Economic Support Measures</span><span class="sc">\n</span><span class="st">in Response to the Covid-19 Pandemic&quot;</span>, <span class="co"># Sets map title</span></span>
<span id="cb54-42"><a href="tutorial.html#cb54-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position=</span><span class="st">&quot;center&quot;</span>, <span class="co"># Specifies title justification</span></span>
<span id="cb54-43"><a href="tutorial.html#cb54-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,          <span class="co"># Specifies title font size</span></span>
<span id="cb54-44"><a href="tutorial.html#cb54-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">inner.margins=</span><span class="fu">c</span>(<span class="fl">0.06</span>,<span class="fl">0.10</span>,<span class="fl">0.10</span>,<span class="fl">0.08</span>), <span class="co"># Sets map margins with respect to frame</span></span>
<span id="cb54-45"><a href="tutorial.html#cb54-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">attr.outside =</span> <span class="cn">TRUE</span>)<span class="sc">+</span>       <span class="co"># Places map credits outside frame</span></span>
<span id="cb54-46"><a href="tutorial.html#cb54-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_credits</span>(<span class="st">&quot;Map Author: Aditya Ranganath</span><span class="sc">\n</span><span class="st">Dataset Author: Simon Porcher</span><span class="sc">\n</span><span class="st">CRS: WGS1984</span><span class="sc">\n</span><span class="st">Source: ICPSR&quot;</span>, <span class="co"># Sets text for map credits</span></span>
<span id="cb54-47"><a href="tutorial.html#cb54-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">position=</span><span class="fu">c</span>(<span class="fl">0.78</span>,<span class="dv">0</span>), <span class="co"># Specifies location of map credits</span></span>
<span id="cb54-48"><a href="tutorial.html#cb54-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">0.38</span>)          <span class="co"># Specifies font size of credits text</span></span>
<span id="cb54-49"><a href="tutorial.html#cb54-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-50"><a href="tutorial.html#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Views &quot;covid_economic_map&quot; object</span></span>
<span id="cb54-51"><a href="tutorial.html#cb54-51" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-55-1.png" title="Reproduces map created in lesson and generated through summary script. Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is a horizontal bar that displays values using a continuous color gradient with custom-chosen numbers arrayed below the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map below and to the left of South America and is titled 'Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)'; the legend title is in bold and placed over the horizontal legend bar. There is no map frame surrounding the map. The map's title is 'Scope of National Economic Support Measures in Response to the Covid-19 Pandemic', which is split into two lines and centered at the top of the map above the northern-most countries. The map map credits are split across four lines, and printed on the bottom-right of the map below Australia and New Zealand. " alt="Reproduces map created in lesson and generated through summary script. Choropleth world map showing variation in country-level average of covid economic intervention index; green color scheme ranging from lighter shades of green to represent lower values of the index and darker shades of green to represent higher values; countries without data are filled in with gray The map legend is a horizontal bar that displays values using a continuous color gradient with custom-chosen numbers arrayed below the gradient to help inform the viewer about the data distribution. The legend is displayed on the bottom-left of the map below and to the left of South America and is titled 'Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)'; the legend title is in bold and placed over the horizontal legend bar. There is no map frame surrounding the map. The map's title is 'Scope of National Economic Support Measures in Response to the Covid-19 Pandemic', which is split into two lines and centered at the top of the map above the northern-most countries. The map map credits are split across four lines, and printed on the bottom-right of the map below Australia and New Zealand. " width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="preliminaries-and-set-up.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practice-exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aranganath24/icpsr_mapping_manual/edit/master/04-main-lesson.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/aranganath24/icpsr_mapping_manual/blob/master/04-main-lesson.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
