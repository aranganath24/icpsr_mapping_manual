<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Tutorial | A Guide to Mapping ICPSR Data in R Studio</title>
  <meta name="description" content="4 Tutorial | A Guide to Mapping ICPSR Data in R Studio" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Tutorial | A Guide to Mapping ICPSR Data in R Studio" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Tutorial | A Guide to Mapping ICPSR Data in R Studio" />
  
  
  

<meta name="author" content="Aditya Ranganath" />


<meta name="date" content="2021-09-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="preliminaries-and-set-up.html"/>
<link rel="next" href="practice-and-challenge-exercises.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Mapping ICPSR Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#motivation"><i class="fa fa-check"></i><b>2.1</b> Motivation</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#scope-and-objectives"><i class="fa fa-check"></i><b>2.2</b> Scope and Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html"><i class="fa fa-check"></i><b>3</b> Preliminaries and Set-Up</a>
<ul>
<li class="chapter" data-level="3.1" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a></li>
<li class="chapter" data-level="3.2" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#r-and-r-studio-installation"><i class="fa fa-check"></i><b>3.2</b> R and R Studio Installation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#windows-installation-instructions"><i class="fa fa-check"></i><b>3.2.1</b> Windows Installation Instructions</a></li>
<li class="chapter" data-level="3.2.2" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#macos-installation-instructions"><i class="fa fa-check"></i><b>3.2.2</b> macOS Installation Instructions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#the-r-studio-interface"><i class="fa fa-check"></i><b>3.3</b> The R Studio Interface</a></li>
<li class="chapter" data-level="3.4" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#install-packages"><i class="fa fa-check"></i><b>3.4</b> Install Packages</a></li>
<li class="chapter" data-level="3.5" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#load-libraries"><i class="fa fa-check"></i><b>3.5</b> Load Libraries</a></li>
<li class="chapter" data-level="3.6" data-path="preliminaries-and-set-up.html"><a href="preliminaries-and-set-up.html#set-working-directory"><i class="fa fa-check"></i><b>3.6</b> Set Working Directory</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tutorial.html"><a href="tutorial.html"><i class="fa fa-check"></i><b>4</b> Tutorial</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tutorial.html"><a href="tutorial.html#load-and-view-data"><i class="fa fa-check"></i><b>4.1</b> Load and View Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tutorial.html"><a href="tutorial.html#icpsr-covid-19-tabular-data"><i class="fa fa-check"></i><b>4.1.1</b> ICPSR Covid-19 Tabular Data</a></li>
<li class="chapter" data-level="4.1.2" data-path="tutorial.html"><a href="tutorial.html#country-boundaries-spatial-data"><i class="fa fa-check"></i><b>4.1.2</b> Country Boundaries Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tutorial.html"><a href="tutorial.html#edit-spatial-data"><i class="fa fa-check"></i><b>4.2</b> Edit Spatial Data</a></li>
<li class="chapter" data-level="4.3" data-path="tutorial.html"><a href="tutorial.html#process-icpsr-tabular-data-for-mapping"><i class="fa fa-check"></i><b>4.3</b> Process ICPSR Tabular Data for Mapping</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tutorial.html"><a href="tutorial.html#select-variables"><i class="fa fa-check"></i><b>4.3.1</b> Select Variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="tutorial.html"><a href="tutorial.html#change-class-of-economic_measures-index"><i class="fa fa-check"></i><b>4.3.2</b> Change class of “Economic_Measures” Index</a></li>
<li class="chapter" data-level="4.3.3" data-path="tutorial.html"><a href="tutorial.html#compute-average-of-economic_measures-index"><i class="fa fa-check"></i><b>4.3.3</b> Compute average of “Economic_Measures” index</a></li>
<li class="chapter" data-level="4.3.4" data-path="tutorial.html"><a href="tutorial.html#calculate-summary-statistics"><i class="fa fa-check"></i><b>4.3.4</b> Calculate Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tutorial.html"><a href="tutorial.html#join-datasets"><i class="fa fa-check"></i><b>4.4</b> Join Datasets</a></li>
<li class="chapter" data-level="4.5" data-path="tutorial.html"><a href="tutorial.html#make-maps"><i class="fa fa-check"></i><b>4.5</b> Make Maps</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tutorial.html"><a href="tutorial.html#make-a-preliminary-map"><i class="fa fa-check"></i><b>4.5.1</b> Make a Preliminary Map</a></li>
<li class="chapter" data-level="4.5.2" data-path="tutorial.html"><a href="tutorial.html#customize-legend"><i class="fa fa-check"></i><b>4.5.2</b> Customize Legend</a></li>
<li class="chapter" data-level="4.5.3" data-path="tutorial.html"><a href="tutorial.html#add-map-title-and-credits"><i class="fa fa-check"></i><b>4.5.3</b> Add Map Title and Credits</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tutorial.html"><a href="tutorial.html#export-your-map"><i class="fa fa-check"></i><b>4.6</b> Export Your Map</a></li>
<li class="chapter" data-level="4.7" data-path="tutorial.html"><a href="tutorial.html#make-a-web-map"><i class="fa fa-check"></i><b>4.7</b> Make a Web Map</a></li>
<li class="chapter" data-level="4.8" data-path="tutorial.html"><a href="tutorial.html#summary"><i class="fa fa-check"></i><b>4.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practice-and-challenge-exercises.html"><a href="practice-and-challenge-exercises.html"><i class="fa fa-check"></i><b>5</b> Practice and Challenge Exercises</a></li>
<li class="chapter" data-level="6" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide to Mapping ICPSR Data in R Studio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tutorial" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Tutorial</h1>
<div id="load-and-view-data" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Load and View Data</h2>
<p>Now that we’ve taken care of those preliminary steps, let’s bring in the tutorial data into our R environment so that we can begin working with it. There are two pieces of data we’ll need to load:</p>
<ul>
<li>The ICPSR tabular dataset on government policy responses to Covid-19 (Section 4.1.1)</li>
<li>A spatial dataset of world country boundaries; we will bring this dataset into R Studio via the <code>ne_countries</code> function of the “rnaturalearth” package (Section 4.1.2)</li>
</ul>
<div id="icpsr-covid-19-tabular-data" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> ICPSR Covid-19 Tabular Data</h3>
<p>When importing tabular data that you have saved on our computer into R Studio, it’s important to first understand some of the details of the data we’re trying to import. The first thing to note is the type of file we’re working with, which is indicated by the file extension; here, we can note that the ICPSR data is a .xlsx file, which means that it’s an Excel file (but note that .xlsx files can also be opened in spreadsheet software programs other than Excel). That means we’ll have to import it into R Studio using a function designed specifically to handle Excel files. To that end, we’ll use the <code>read_excel</code> function from the <em>readxl</em> package. Recall that if you want to learn more about a function or a package, simply type a question mark followed by the package or function name in the console, and relevant information will appear in the “Help” tab of the “Files/Plots/Packages/Help/Viewer” window on the bottom right of our R Studio interface. For example, if we wanted to learn more about the <code>read_excel</code>function, we would type <code>?read_excel</code> into the console.</p>
<p>Before using the <code>read_excel</code> function to bring in the , it could be helpful to open up the data outside the R environment to see whether the dataset has any features that we have to account for when loading it into our R environment. When we first open the spreadsheet, it will look something like this:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="images/excel_open.png" alt="ICPSR Dataset in Spreadsheet: Description Tab" width="100%" />
<p class="caption">
Figure 4.1: ICPSR Dataset in Spreadsheet: Description Tab
</p>
</div>
<p>Note that when we open the spreadsheet, we land on its first tab (or “sheet”), which is titled “Description”. This part of the spreadsheet effectively functions as a data codebook, which we can look through to understand the dataset’s various variables and and assess how they were measured. To open up the actual dataset, we can toggle to the “Dataset” tab by pressing the corresponding button on the bottom-left of the spreadsheet (highlighted in red below):</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="images/excel_tabs.png" alt="ICPSR Dataset in Spreadsheet: Dataset Tab" width="100%" />
<p class="caption">
Figure 4.2: ICPSR Dataset in Spreadsheet: Dataset Tab
</p>
</div>
<p>The fact that the ICPSR dataset has two sheets within it is important; it means that when we load it into R, we’ll have to explicitly specify the sheet (i.e. the “Dataset” sheet) we want to import.</p>
<p>Now, let’s go ahead and load the “Dataset” sheet of the ICPSR data file. Type the following code into your script, and run it:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="tutorial.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imports &quot;Dataset&quot; sheet from ICPSR Excel file into R Studio, and assigns the dataset to an object called &quot;covid_data&quot;</span></span>
<span id="cb6-2"><a href="tutorial.html#cb6-2" aria-hidden="true" tabindex="-1"></a>covid_data<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;Gov_Responses2Covid19_last.xlsx&quot;</span>, <span class="at">sheet=</span><span class="st">&quot;Dataset&quot;</span>)</span></code></pre></div>
<p>Let’s unpack that code. As we noted above, <code>read_excel</code> is the function used to bring in Excel spreadsheet data into R. The function has two arguments; the first (“Gov_Responses2Covid19_last.xlsx”) is the name of the file we want to import, while the second (sheet=“Dataset”) specifies that we specifically want to import the the “Dataset” sheet from that Excel file. This code is then assigned, using <code>&lt;-</code> (R’s assignment operator) to a new object that we call <code>covid_data</code>. This means that the output of the code on the right hand side of the assignment operator is now assigned to the <code>covid_data</code> object. Think of this object as a container of sorts, one which holds, or “contains”, the output of the code to the right of the assignment operator. Object assignment isn’t necessary; we could have brought the data into R Studio by simply typing the code to the right of the assignment operator. However, assigning the dataset to an object allows for the more flexible and intuitive handling of data, so it is a common practice.</p>
<p>Note that after typing the code from the previous codeblock into your R script and running it, you still won’t actually see the dataset within the R environment. There are many ways to pull up and inspect the data; in this tutorial, we’ll use the <code>View</code> function, which will bring up the data as a separate tab in the “Source” window. To display the contents of the <code>covid_data</code> object (in other words, the dataset we just imported), type and run the following code:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="tutorial.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Brings up dataset held in the &quot;covid_data&quot; object in R Studio&#39;s data viewer</span></span>
<span id="cb7-2"><a href="tutorial.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_data)</span></code></pre></div>
<p>Within your R Studio environment, the result of running <code>View(covid_data)</code> will look something like this (dataset outlined in red):</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="images/viewdata.png" alt="Viewing ICPSR Dataset in R Environment" width="100%" />
<p class="caption">
Figure 4.3: Viewing ICPSR Dataset in R Environment
</p>
</div>
<p>You can scroll up/down and across the dataset within the data viewer.</p>
</div>
<div id="country-boundaries-spatial-data" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Country Boundaries Spatial Data</h3>
<p>Now that we have our tabular data on government responses to Covid-19 loaded into R Studio, let’s bring spatial data on world country borders into memory. Eventually, we’ll represent the Covid-19 data on a map by joining it to the spatial data on country boundaries that we will now bring in.</p>
<p>When working with spatial data in R, you will sometimes want to import data that you collected on your own, or data that you downloaded. There are several functions in the <code>sf</code> package that will allow you to easily import your external spatial data in R; if you need to do this, you should consult the package’s documentation.</p>
<p>In our case, we won’t have to download and import the spatial data we need into R Studio, since there are R packages that already contain this spatial data. In particular, we’ll use the <code>ne_countries</code> function of the <em>rnaturalearth</em> package to bring the country border dataset into our R environment. Note the two arguments we pass into the <code>ne_countries</code> function: the “scale” argument specifies that we want to use a medium scale when rendering the map (the other options are ‘small’ and ‘large’), while the “returnclass” argument specifies that we want the spatial dataset in ‘sf’ format, which is a spatial data format that works well with the <em>tmap</em> mapping package we’ll use later. As in the previous section, we’ll assign the dataset to an object so that we can easily work with it later; we’ll call this object “country_boundaries”:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="tutorial.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Brings spatial dataset of country boundaries into R environment using the rnaturalearth package</span></span>
<span id="cb8-2"><a href="tutorial.html#cb8-2" aria-hidden="true" tabindex="-1"></a>country_boundaries<span class="ot">&lt;-</span><span class="fu">ne_countries</span>(<span class="at">scale=</span><span class="st">&quot;medium&quot;</span>, <span class="at">returnclass=</span><span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
<p>Now that we have this spatial dataset in memory and assigned to an object, let’s step back and clarify what exactly a spatial dataset is. In some respects, a spatial dataset is like a typical tabular dataset. To see this, let’s pass the “country_boundaries” object through the <code>View()</code> function to open up the dataset:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="tutorial.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(country_boundaries)</span></code></pre></div>
<p>By scrolling across the dataset, you’ll notice that each row corresponds to a country, and that there are many columns that correspond to various country-level attributes. The key column, however, which makes this a spatial dataset (as opposed to merely a tabular one), is the information contained in a column called “geometry”. This column contains geographic coordinate information that essentially defines a polygon for each country in the dataset. The “geometry” column is likely one of the last columns in the dataset, so you may have to scroll a bit to find it. Alternatively, we can use the <code>relocate</code> function in the <em>dplyr</em> package to make the “geometry” column the first column in the dataset within “country_boundaries”, and then view this reordered dataset using the <code>View</code> function. The first argument passed to the <code>relocate</code> function (“country_boundaries”) indicates the object that contains the relevant dataset, and the second argument ("geometry) indicates the name of the column we want to move to the front of the dataset.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="tutorial.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">relocate</span>(country_boundaries, geometry))</span></code></pre></div>
<p>After typing in that code and running it in your script, the window with the reordered dataset should appear in your source window; note the “geometry” tab:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="images/geometry.png" alt="Geometry Column Contains Spatial Information" width="100%" />
<p class="caption">
Figure 4.4: Geometry Column Contains Spatial Information
</p>
</div>
<p>We can use the information in the “geometry” tab to draw georeferenced polygons for each row in the spatial dataset, which will yield a world map! To translate the information in the geometry tab into a cartographic representation, we’ll use a package called <em>tmap</em>. To bring up the features of the dataset, we have to first tell <em>tmap</em> what dataset contains the information we want to map; we do this by first passing the name of the object that contains the relevant dataset (here, “country_boundaries”) to the <code>tm_shape</code> function, and then specifying that our features (i.e. country borders) are represented as polygons through the <code>tm_polygons</code> function. The <code>tm_polygons</code> function does not require any arguments. In the <em>tmap</em> package, we can connect functions together through a plus sign (+). When we type in and run the following code, the result is a map that is rendered based on the information in the “geometry” column:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="tutorial.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># maps geographic features (i.e. countries) of spatial dateset</span></span>
<span id="cb11-2"><a href="tutorial.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(country_boundaries)<span class="sc">+</span></span>
<span id="cb11-3"><a href="tutorial.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>We can assign this map to an object, just as we assigned the ICPSR tabular dataset to an object. Let’s call this object “worldmap.”</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="tutorial.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assigns map of geographic features to a new object called &quot;worldmap&quot; </span></span>
<span id="cb12-2"><a href="tutorial.html#cb12-2" aria-hidden="true" tabindex="-1"></a>worldmap<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(country_boundaries)<span class="sc">+</span></span>
<span id="cb12-3"><a href="tutorial.html#cb12-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>()</span></code></pre></div>
<p>Having assigned the map to the “worldmap” object, we can bring up the map whenever we want by simply calling “worldmap” object: t:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="tutorial.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calls &quot;worldmap&quot; object to display country-level map generated from the &quot;country_boundaries&quot; spatial dataset </span></span>
<span id="cb13-2"><a href="tutorial.html#cb13-2" aria-hidden="true" tabindex="-1"></a>worldmap</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Within the R Studio interface, we can see the above map within the bottom-right window after selecting the “Plots” tab:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-22"></span>
<img src="images/worldmap_window.png" alt="World Map in &quot;Plots&quot; Tab (Rendered from Spatial Dataset" width="100%" />
<p class="caption">
Figure 4.5: World Map in “Plots” Tab (Rendered from Spatial Dataset
</p>
</div>
<p>We can enlarge the map in this window by clicking the “Zoom” link; this will produce an enlarged version of the map in a separate window:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="images/zoom2.png" alt="Enlarging Map with &quot;Zoom&quot; Button" width="100%" />
<p class="caption">
Figure 4.6: Enlarging Map with “Zoom” Button
</p>
</div>
</div>
</div>
<div id="edit-spatial-data" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Edit Spatial Data</h2>
<p>We can edit spatial datasets in R Studio with relative ease, using commonly used R packages. Let’s say, for example, that we don’t want Antarctica to appear on our map (since Antarctica typically does not appear on political maps of the world).</p>
<p>To delete Antarctica from the map, we first need to delete the row that corresponds to Antarctica from the spatial dataset contained in the “country_boundaries” object. We can do so with the following code:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="tutorial.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deletes Antarctica from spatial dataset in &quot;country_boundaries&quot; object</span></span>
<span id="cb14-2"><a href="tutorial.html#cb14-2" aria-hidden="true" tabindex="-1"></a>country_boundaries<span class="ot">&lt;-</span>country_boundaries <span class="sc">%&gt;%</span> <span class="fu">filter</span>(iso_a3 <span class="sc">!=</span><span class="st">&quot;ATA&quot;</span>)</span></code></pre></div>
<p>We can translate this code into ordinary language as follows: “Take the existing country boundaries dataset (<code>country_boundaries</code> to the left of the <code>%&gt;%</code> and after the assignment operator) and then (<code>%&gt;%</code>, a symbol called a pipe, which is used to chain together code) select only the countries that are not Antarctica (<code>filter(iso_a3 !="ATA"</code>). Take this new dataset, which doesn’t include Antarctica, and assign it back to the existing ‘country_boundaries’ object (<code>country_boundaries&lt;-</code>), which effectively replaces the previous spatial dataset in the country_boundaries object (which did include Antarctica).”</p>
<p>Two things may require additional elaboration:</p>
<ul>
<li>First is the pipe, the symbol that looks like this: %&gt;%. The pipe operator essentially takes the output of the code on its left, and then use that output as an input to the code on its right. Here, the pipe is taking the output of the Here, the pipe is taking the output of the “country_dataset” object (i.e. the existing spatial dataset) on its left, and then using that output as an input to the <code>filter</code> function on its right. In other words, the pipe operator links the code on its two sides, and indicates that the object being passed through the <code>filter</code> function is the “country_boundaries” object.</li>
<li>The <code>filter</code> function is a function from the <em>dplyr</em> package that allows one to select rows from a dataset by specified criteria. In our case, we want to select all rows from the dataset that are not Antarctica. The argument to the <code>filter</code> function, <code>iso_a3 !="ATA"</code>, is essentially saying “return any records where the iso_a3 variable in the attribute table (the 3-digit ISO country code) is NOT equal to”ATA" (Antarctica’s code). Note that <code>!=</code> is R syntax for “not equal to”.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></li>
</ul>
<p>Now, let’s see this change reflected in the corresponding map. To do so, we must update the “worldmap” object by rerunning the object assignment. The worldmap object we defined above will not automatically reflect the edits we just made to the “country_boundaries” dataset; we need to run the code again with the edited version of the dataset “country_boundaries” object passed through the <code>tm_shape</code> function:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="tutorial.html#cb15-1" aria-hidden="true" tabindex="-1"></a>worldmap<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(country_boundaries)<span class="sc">+</span></span>
<span id="cb15-2"><a href="tutorial.html#cb15-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>()</span></code></pre></div>
<p>Now, let’s view our updated map:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="tutorial.html#cb16-1" aria-hidden="true" tabindex="-1"></a>worldmap</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>As desired, Antarctica has been deleted from the spatial dataset, and therefore no longer appears on the corresponding map.</p>
</div>
<div id="process-icpsr-tabular-data-for-mapping" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Process ICPSR Tabular Data for Mapping</h2>
<p>In order to represent the ICPSR data on governments’ economic responses to Covid-19 on a map, we must join the ICPSR dataset (contained in the “covid_data” object) to the spatial dataset (contained in the “country_boundaries” object); at that point, we’ll have a new, integrated dataset that will include the country-level Covid-19 data of interest in a spatial dataset. We can then display that Covid-19 information on a map by using the <code>tmap</code> package.
Before we can take those steps, however, we need to process the ICPSR tabular data with a view towards facilitating the joining and mapping process.</p>
<div id="select-variables" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Select Variables</h3>
<p>When working with data in R, it is often useful to get a quick sense of a given dataset’s dimensions, which we can do using the <code>dim</code> function. Below, we pass the “covid_data” object through the <code>dim</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="tutorial.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(covid_data)</span></code></pre></div>
<pre><code>## [1] 62700    43</code></pre>
<p>The output indicates that there are 62700 rows in the dataset, and 43 columns. This suggests that there are quite a few variables in the dataset. Given that we’re only interested in mapping (for now) the variable that represents an aggregate index (computed from other variables in the dataset) of the generosity of governments’ economic support measures in response to the pandemic, we’ll go ahead and delete superfluous columns so as to keep the size of the final (joined) dataset tractable. The name of the variable we’d like to map, and therefore keep, is “Economic_Measure” (see the dataset’s documentation for more details). In addition to keeping this variable, we also need to keep a column titled “iso”, which is the 3-digit ISO country code; this ISO code also exists in the spatial dataset to which we want to join the “Economic_Measure” variable, and so we will use these ISO codes as the joining variable.</p>
<p>Let’s create a new object, which we’ll call “covid_data_economic”, to contain this smaller dataset comprised of the ISO code and the economic interventions index we’re interested in mapping:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="tutorial.html#cb19-1" aria-hidden="true" tabindex="-1"></a>covid_data_economic<span class="ot">&lt;-</span>covid_data <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="tutorial.html#cb19-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(iso, Economic_Measures) </span></code></pre></div>
<p>The above code can be translated as follows: “Start with the dataset in the ‘covid_data’ object (‘covid_data’), and then keep the ‘iso’ and ‘Economic_Measures’ columns but discard everything else (‘select(iso, Economic_Measures)). Assign this new 2-column dataset to a new object called ’covid_data_economic’ (‘covid_data_economic&lt;-’).” We can take a look at this smaller dataset extracted from the original dataset by passing the “covid_data_economic” object as an argument to the now-familiar <code>View</code> function:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="tutorial.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_data_economic)</span></code></pre></div>
<p>Within the “Source” window, a new tab that contains the smaller 2-column dataset that is within the “covid_data_economic” object will appear:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-30"></span>
<img src="images/selection.png" alt="New Dataset Based on Selection from Original Dataset" width="100%" />
<p class="caption">
Figure 4.7: New Dataset Based on Selection from Original Dataset
</p>
</div>
<p>Note that the original Covid-19 policy responses dataset, stored in the “covid_data” object, is unaffected by our creation of a new dataset based on the selection of these two variables. You can confirm that this original data is still stored in the “covid_data” object by opening it up:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="tutorial.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_data)</span></code></pre></div>
<p>We can go back to this initial dataset (in the “covid_data” object) anytime we might need, but for now we’ll set it aside and start working with our newly created dataset in the “covid_data_economic” object.</p>
</div>
<div id="change-class-of-economic_measures-index" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Change class of “Economic_Measures” Index</h3>
<p>Recall that the data we want to map is contained within the “Economic_Measures” field of the dataset in the newly created “covid_data_economic” dataset. R has six fundamental “types” of data: character, numeric, integer, logical, and complex. The code below extracts the “Econmic_Measures” column from the dataset (placing a dollar sign in between the name of an object containing a dataset, and a column containing that dataset, as in <code>covid_data_economic$Economic_Measures</code> is a way of isolating and extracting a column from a larger dataset), and then passes it through the <code>class</code> function to identify the class of the “Economic_Measures” field.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="tutorial.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the class of the &quot;Economic_Measures&quot; field</span></span>
<span id="cb22-2"><a href="tutorial.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(covid_data_economic<span class="sc">$</span>Economic_Measures)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>We can see from the above output that the class of the “Economic_Measures” variable is “character”, which implies that although the information in the “Economic_Measures” variable looks like it is numeric, R is not actually reading that data as numbers. So, we have to change the way that data is encoded, and ensure that it will be interpreted numerically; the failure to do this will prevent us from making numerical calculations using this data, as well as from mapping it using <em>tmap</em>. We can essentially recode the information in the “Economic_Measures” variable as “numeric” using the following code:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="tutorial.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changes class of &quot;Economic_Measures&quot; field from character to numeric</span></span>
<span id="cb24-2"><a href="tutorial.html#cb24-2" aria-hidden="true" tabindex="-1"></a>covid_data_economic<span class="sc">$</span>Economic_Measures<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(covid_data_economic<span class="sc">$</span>Economic_Measures)</span></code></pre></div>
<p>In the code above, the code to the right of the assignment operator extracts the “Economic_Measures” column from the the “covid_data_economic” dataset, and then changes its class to numeric using the <code>as.numeric</code> function. The assignment operator then assigns this numeric version of the “Economic_Measures” field back into the original dataset contained in the “covid_data_economic” object (the one with the character field); in performing this assignment, the “character” version of the “Economic_Measures” field is replaced with the “numeric” version. At this point, the “Economic_Measures” column in our dataset within the “covid_data_economic” object is numeric; we can confirm this by passing the column through the class function once again:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="tutorial.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the class of the updated &quot;Economic_Measures&quot; field</span></span>
<span id="cb25-2"><a href="tutorial.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(covid_data_economic<span class="sc">$</span>Economic_Measures)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
</div>
<div id="compute-average-of-economic_measures-index" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Compute average of “Economic_Measures” index</h3>
<p>As we mentioned earlier, the ICPSR dataset on government policies with respect to Covid-19 is a time-series dataset, containing monthly observations over the course of about a year during the pandemic (January 2020 to October 2020). This means that we have to make some choices about how to represent the “Economic_Measures” index on a map. For example, do we want to pick one of the months to map? Do we want to map the change across two different months? Do we want to map the average index value across all the months in the sample?</p>
<p>There are of many possibilities, but let’s choose to go ahead and map the average. That is, for each country, we’ll average the value of the “Economic_Measures” index across all of the months in the dataset; the value that we’ll eventually map will be this average value of the “Economic_Measures” index.</p>
<p>To that end, we need to take our current “covid_data_economic”, which contains monthly observations for each country, and transform it into a new dataset that contains the monthly average of the “Economic_Measures” index for each country.</p>
<p>The code below carries out this transformation of the data:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="tutorial.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Country-Level Averages for &quot;Economic_Measures&quot; Index, and then assign this new dataset of country-level averages to a new object called &quot;covid_data_economic_avg&quot;. </span></span>
<span id="cb27-2"><a href="tutorial.html#cb27-2" aria-hidden="true" tabindex="-1"></a>covid_data_economic_avg<span class="ot">&lt;-</span>covid_data_economic <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(iso) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="tutorial.html#cb27-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">summarize</span>(<span class="at">mean_economic=</span><span class="fu">mean</span>(Economic_Measures, <span class="at">na.rm=</span><span class="cn">FALSE</span>))</span></code></pre></div>
<p>Let’s unpack this code, starting with the code that’s to the right of the assignment operator.</p>
<ul>
<li>We start by calling the “covid_data_economic” object, which establishes that this is essentially the “base” dataset we wish to modify.</li>
<li>Then (recall that the <code>%&gt;%</code> is used to chain together code by taking the output on the left and passing it as input into the code to its right), we call the <code>group_by</code> function, and pass “iso” as an argument to this function; this stipulates that all observations with the same ISO code are to be considered a group, and that any subsequent calculations will therefore be performed at the country level. This step ensures that when we calculate the mean of the “Economic_Measures” variable, the function will return the mean value of this index for each individual country, rather than the mean value for the dataset as a whole.</li>
<li>After setting the grouping variable and using another pipe (<code>%&gt;%</code>) to establish that we are passing the newly grouped dataset as an input into the subsequent code, we call the <code>summarize</code> function. This function creates a new dataset based on the calculation of summary statistics for an existing dataset. By calling <code>summarize</code>, we are specifying that we want to create a new dataset to hold the information on country-level averages for the “Economic_Measures” data.</li>
<li>Within the <code>summarize</code> function, we first need to create a name for the column that will contain the country-level averages for the “Economic_Measures” index. We’ll call this variable “mean_economic”, which corresponds to the very first part of the code after the parentheses. We set this variable equal to an expression that passes the “Economic_Measures” variable through the <code>mean</code> function. In essence, this calculates the mean of the “Economic_Measures” variable for each country (it calculates the country-level mean because we specified the grouping function, <code>group_by(iso)</code>, in the previous line of code), and creates a column in the newly created dataset named “mean_economic” to store this information. The code that reads <code>na.rm=FALSE</code> simply specifies that missing data should be ignored in the calculation of the mean value of the “Economic_Measures” index.</li>
<li>Finally, the this new dataset, consisting of two columns (one column containing ISO codes, and the other, named “mean_economic” containing the corresponding country-level mean of the “Economic_Measures” variable) is assigned to a new object called “covid_data_economic_avg”.</li>
</ul>
<p>We can translate the above code as follows: “Take the existing dataset within the ‘covid_data_economic’ object, and then group this dataset by the ISO country codes; then, generate a new dataset, containing one column with ISO country codes, and another column, named”mean_economic“, that contains information on the country-level mean of the ‘Economic_Measures’ index. Finally, assign this new dataset to an object called ‘covid_data_economic_avg’”</p>
<p>To inspect this new dataset within the Source window, simply pass the object through the <code>View</code> function.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="tutorial.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(covid_data_economic_avg)</span></code></pre></div>
<p>We should see something that looks like this:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-37"></span>
<img src="images/mean_economic.png" alt="Dataset of Country-Level Averages for &quot;Economic_Measures&quot; Index" width="100%" />
<p class="caption">
Figure 4.8: Dataset of Country-Level Averages for “Economic_Measures” Index
</p>
</div>
</div>
<div id="calculate-summary-statistics" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Calculate Summary Statistics</h3>
<p>Now that we have a dataset containing the country-level average of the “Economic_Measures” index (which is the data we’d like to map), it can be useful to get a sense of how the data is distributed. We can easily do this by using the <code>summary</code> function, which returns a table of summary statistics for a specified variable. The following code produces summary statistics for the “mean_economic” variable within the dataset that is contained in the “covid_data_economic_average” dataset (which is written as <code>covid_data_economic$mean_economic</code>):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="tutorial.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(covid_data_economic_avg<span class="sc">$</span>mean_economic)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##  0.0000  0.2787  0.3930  0.3853  0.5074  0.7236      30</code></pre>
</div>
</div>
<div id="join-datasets" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Join Datasets</h2>
<p>We’re almost ready to map our data. But before doing that, we will have to take our dataset of average “Economic_Measures” scores by country (contained in the “covid_data_economic_avg” object we just created), and then join this dataset to our previously discussed spatial dataset of country boundaries (contained in the “country_boundaries” object). In other words, before mapping our variable of interest, we need to bring this variable into the dataset of country boundaries.</p>
<p>The task of joining, or “merging” datasets is a very common procedure when working with social science data (or any data for that matter), since data is often held in many different locations; before being able to analyze it, one has to bring all of the relevant data into the same dataset. That is essentially what we’re doing here.</p>
<p>How do we join different datasets together? Associating two datasets into one larger dataset that combines information from both requires the datasets to share a common field; this common field can be used to essentially “glue” the datasets together. The International Organization for Standardization provides 3-digit country codes for each of the world’s countries that can be used to uniquely identify countries when working with country-level data. Both our spatial dataset, and our table of the “Economic_Measures” index averages, contain a field with these standardized 3-digit ISO codes (this field is labelled “iso_a3” in the spatial dataset, and “iso” in the dataset containing the “Economic_Measures” average). We we will therefore use the 3-digit country code field to join the column containing the “Economic_Measures” average to the spatial dataset.</p>
<p>The code below carries out this task:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="tutorial.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join dataset with country-level means for &quot;Economic_Measures&quot; index</span></span>
<span id="cb31-2"><a href="tutorial.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (in &quot;covid_data_economic&quot; object) to spatial dataset of world boundaries </span></span>
<span id="cb31-3"><a href="tutorial.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (in &quot;country_boundaries&quot; object), based on common 3-Digit ISO Codes</span></span>
<span id="cb31-4"><a href="tutorial.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="tutorial.html#cb31-5" aria-hidden="true" tabindex="-1"></a>worldmap_covid_data_economic<span class="ot">&lt;-</span><span class="fu">full_join</span>(country_boundaries, covid_data_economic_avg, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;iso_a3&quot;</span><span class="ot">=</span><span class="st">&quot;iso&quot;</span>))</span></code></pre></div>
<ul>
<li>In the code above, we use the <code>full_join</code> function to connect our datasets together. A “full join” keeps all rows in both datasets, even if one dataset does not have certain rows (i.e. countries) that the other does not (and vice-versa). For more information on different join options, explore the documentation by inspecting the function’s documentation (<code>?full_join</code>).</li>
<li>The first argument to the full_join function is “country_boundaries”, which is of course the object containing our spatial dataset.</li>
<li>The second argument, “covid_data_economic_avg” is the tabular dataset containing information on country_level averages for the Covid economic intervention index (i.e. the data we ultimately want to map).<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></li>
<li>The third argument specifies the join fields, i.e. the fields within the datasets that contain the common variable that can be used to correlate the records in the two different datasets and weld them together. In our case, the join variable is of course the 3-digit country ISO code. The argument that reads <code>by=c("iso_a3"="iso")</code> simply indicates that we want to join the datasets based on the set of country identifiers given by the 3-digit ISO codes; because the name of the column containing the 3-digit codes is different in the two datasets, the expression in the parentheses <code>"iso_a3"="iso"</code> simply indicates that the column named “iso_a3” (in the spatial dataset) and the column named (iso) in the tabular dataset are equivalent to each other, and are to be used as the join fields. If they didn’t have different names–for example, if the ISO codes were in a column named “iso” in <em>both</em> datasets–we could simply have written <code>by=iso</code> to specify the join column.</li>
<li>Finally, we take our newly created dataset, which adds the data we want to map into the spatial dataset, and assign it to a new object that we can call when building our map(s). We call this object “worldmap_covid_data_economic.”</li>
</ul>
<p>We can translate the code in the previous code block as follows: “Join the dataset in the ‘covid_data_economic_avg’ object to the spatial dataset in the ‘country_boundaries’ obejct using columns in each of the two datasets containing information on countries’ 3-Digit ISO codes as the join fields (the column with ISO information in the spatial dataset is named ‘iso_a3’ while the column with ISO information in the tabular dataset is ‘iso’). Finally, assign the joined dataset that results to a new object called ‘worldmap_covid_data_economic.’”</p>
<p>Before proceeding, Let’s take a quick look at our newly created joined dataset. To make it easy to inspect, we can move up the variables we’re interested in (country name, the “mean_economic” variable, and the geometry information that makes the data spatial in nature) up to the front of the dataset:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="tutorial.html#cb32-1" aria-hidden="true" tabindex="-1"></a>worldmap_covid_data_economic<span class="ot">&lt;-</span>worldmap_covid_data_economic <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(name, mean_economic, geometry)</span></code></pre></div>
<p>After moving these variables by using the <code>relocate</code> function with the relevant variables as arguments, pass the name of the object containing the joined data (“worldmap_covid_data_economic”), whose variables have now been relocated, through the familiar <code>View</code> function:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="tutorial.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(worldmap_covid_data_economic)</span></code></pre></div>
<p>The dataset that opens up in your Source window should look something like this:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-42"></span>
<img src="images/joineddataset.png" alt="Spatial Dataset With Covid-19 Economic Index Data" width="100%" />
<p class="caption">
Figure 4.9: Spatial Dataset With Covid-19 Economic Index Data
</p>
</div>
<p>Note that we now have a spatial dataset of country boundaries (as indicated by the “name” and “geometry” fields), with the data we want to map (the mean, for each country, of the Covid-19 Economic intervention index during the period under consideration) now included in a field within the spatial dataset.</p>
</div>
<div id="make-maps" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Make Maps</h2>
<p>We’re finally ready to represent the tabular data we started with on a map! To do so, we’ll use the <em>tmap</em> package, which we already used above to view a rendered version of our spatial dataset. Now, we’ll actually represent our data on the map features.</p>
<div id="make-a-preliminary-map" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Make a Preliminary Map</h3>
<p>As with anything else in R, we can assign maps created with the <em>tmap</em> package to objects, which makes it easy to subsquently work with them. We’ll create an object called “covid_economic_map” to contain the map we will build using <em>tmap</em>. We can create a rough draft of a map and assign it to an object with two relatively simple lines of code:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="tutorial.html#cb34-1" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(worldmap_covid_data_economic)<span class="sc">+</span></span>
<span id="cb34-2"><a href="tutorial.html#cb34-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, <span class="at">n=</span><span class="dv">8</span>, <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>)</span></code></pre></div>
<p>In the code above that is to the right of the assignment operator, we first use <em>tmap’s</em> <code>tm_shape</code> function to specify the spatial dataset whose feature’s we’d like to display. Within <em>tmap</em>, chaining together functions requires a <code>+</code> sign, so we add a <code>+</code> before moving to another function on the next line. This is the <code>tm_polygons</code> function, which we use because our spatial dataset of country boundaries represents those boundaries as polygons.
The <code>tm_polygons</code> function can take a variety of arguments that can help us to customize our map; we’ll introduce a few more arguments below, but if you want to see the full range of possible arguments, be sure to check out the function’s documentation (<code>?tm_polygons</code>). Now, tet’s consider the arguments that are being passed through the <code>tm_polygons</code> function:</p>
<ul>
<li><code>col="mean_economic"</code> specifies the name of the column in the spatial dataset (which has been specified with the <code>tm_shape</code> function) that contains the data we’d like to map. Recall from the previous section that the name of this column is “mean_economic.”</li>
<li><code>n=8</code> specifies that we want the data to be partitioned into 8 bins</li>
<li><code>style="jenks"</code> indicates that we want to set break points in the data distribution using the Jenks Natural Breaks Classification; to see other options for partitioning your data, see the function’s documentation. For more information on the Jenks Natural Breaks Classification, as well as other data partition algorithms, see <a href="https://pro.arcgis.com/en/pro-app/2.7/help/mapping/layer-properties/data-classification-methods.htm">here</a>.</li>
<li><code>palette="BuGn"</code> specifies the color scheme we want to use to represent the data. Check out this extremely useful <a href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf">guide</a> on colors and palettes in R (including information on relevant color codes). “BuGn” refers to a blue-green color gradient, which is used to represent variation in the data that’s being mapped.</li>
</ul>
<p>To see what the map looks like, simply call the object which contains it:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="tutorial.html#cb35-1" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>As in Section 4.1.2 above, we can see the map in the “Plots” tab of the bottom-right window, and can open up a larger window by clicking the “Zoom” button right below the “Plots” tab.</p>
<p>Of course, the map we’ve just created needs a bit of work (most noticeably, the legend needs to be moved to a less distracting location), but after all of the previous work to set up our data, hopefully it feels exciting to finally see our tabular data transformed into a map!</p>
<p>Before we work on the legend, we can see how to change certain features of the map using arguments to the <code>tm_polygons</code> function that we’ve already discussed. For instance, let’s say we want a Yellow to Red palette (“YlOrRd”; again, remember you can look up these codes at the color guide linked above), only five intervals for the data, and want the data to be partitioned across intervals equally (rather than by using the Jenks algorithm). Let’s make a new map object to contain this map, called “covid_economic_map_alternative.”</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="tutorial.html#cb36-1" aria-hidden="true" tabindex="-1"></a>covid_economic_map_alt<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(worldmap_covid_data_economic)<span class="sc">+</span></span>
<span id="cb36-2"><a href="tutorial.html#cb36-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, <span class="at">n=</span><span class="dv">5</span>, <span class="at">style=</span><span class="st">&quot;equal&quot;</span>, <span class="at">palette=</span><span class="st">&quot;YlOrRd&quot;</span>)</span></code></pre></div>
<p>Let’s display the map in the “covid_economic_map_alt” object; notice the change in color, the fewer number of classes, and the equal intervals in the legend:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="tutorial.html#cb37-1" aria-hidden="true" tabindex="-1"></a>covid_economic_map_alt</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Note that we can easily remove the map frame if we’d prefer not to have that, with the “Frame” argument to the <code>tm_layout</code> function.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="tutorial.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removes frame from &quot;covid_economic_map_alt&quot; map object</span></span>
<span id="cb38-2"><a href="tutorial.html#cb38-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map_alt<span class="ot">&lt;-</span>covid_economic_map_alt<span class="sc">+</span></span>
<span id="cb38-3"><a href="tutorial.html#cb38-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>)</span>
<span id="cb38-4"><a href="tutorial.html#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="tutorial.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Views amended map object without frame:</span></span>
<span id="cb38-6"><a href="tutorial.html#cb38-6" aria-hidden="true" tabindex="-1"></a>covid_economic_map_alt</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="customize-legend" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Customize Legend</h3>
<p>The biggest issue with the rough drafts of our map from the previous section is the position of the legend. Let’s go back to the first map we made (in the “covid_economic_map” object), and simply switch its legend position, using an argument in the <code>tm_legend</code> function. We’ll also remove the map frame.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="tutorial.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Shift legend position</span></span>
<span id="cb39-2"><a href="tutorial.html#cb39-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(worldmap_covid_data_economic)<span class="sc">+</span></span>
<span id="cb39-3"><a href="tutorial.html#cb39-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, <span class="at">n=</span><span class="dv">8</span>, <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-4"><a href="tutorial.html#cb39-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb39-5"><a href="tutorial.html#cb39-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_legend</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb39-6"><a href="tutorial.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="do">## View Map</span></span>
<span id="cb39-7"><a href="tutorial.html#cb39-7" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Currently, our legend is discrete, but we may want to try using a continuous legend to better match the continuous nature of the index. We can do this by changing the “style” argument to the <code>tm_polygons</code> function. We’ll</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="tutorial.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Changes &quot;style&quot; argument parameter to &quot;cont&quot; to make continuous legend</span></span>
<span id="cb40-2"><a href="tutorial.html#cb40-2" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(worldmap_covid_data_economic)<span class="sc">+</span></span>
<span id="cb40-3"><a href="tutorial.html#cb40-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, <span class="at">style=</span><span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-4"><a href="tutorial.html#cb40-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb40-5"><a href="tutorial.html#cb40-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_legend</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb40-6"><a href="tutorial.html#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="do">## View Map</span></span>
<span id="cb40-7"><a href="tutorial.html#cb40-7" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>Let’s explore some additional ways to customize our legend:</p>
<ul>
<li>Notice that the legend has a “Missing” category, to indicate countries for which we don’t have data on the Covid-19 economic index. Instead of labelling it “Missing” we’ll’ label it as “No Data”.</li>
<li>Let’s give the legend a title that describes the data: Mean of Covid Economic Intervention Index (1/1/2020 to 10/1/2020)".</li>
<li>It’s possible to experiment with different legend orientations. To see this, let’s flip the legend’s orientation, turning it into a horizontal rather than vertical bar.</li>
<li>It’s also possible to specify our own intervals for the legend; we’ll set our legend breaks at 0, 0.25, 0.5, and 0.75.</li>
<li>We’ll customize the size of our legend, as well as the legend’s text.</li>
<li>We’ll alter the location of our legend.</li>
</ul>
<p>The following code incorporates these changes into the previous map:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="tutorial.html#cb41-1" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(worldmap_covid_data_economic)<span class="sc">+</span></span>
<span id="cb41-2"><a href="tutorial.html#cb41-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, </span>
<span id="cb41-3"><a href="tutorial.html#cb41-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">style=</span><span class="st">&quot;cont&quot;</span>, </span>
<span id="cb41-4"><a href="tutorial.html#cb41-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>, </span>
<span id="cb41-5"><a href="tutorial.html#cb41-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">textNA=</span><span class="st">&quot;No Data&quot;</span>, </span>
<span id="cb41-6"><a href="tutorial.html#cb41-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title=</span><span class="st">&quot;Mean of Covid</span><span class="sc">\n</span><span class="st">Economic</span><span class="sc">\n</span><span class="st">Intervention Index</span><span class="sc">\n</span><span class="st">(1/1/2020 to</span><span class="sc">\n</span><span class="st"> 10/1/2020)&quot;</span>, </span>
<span id="cb41-7"><a href="tutorial.html#cb41-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">legend.is.portrait=</span><span class="cn">FALSE</span>,</span>
<span id="cb41-8"><a href="tutorial.html#cb41-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>, <span class="fl">0.75</span>))<span class="sc">+</span></span>
<span id="cb41-9"><a href="tutorial.html#cb41-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tm_layout</span>(<span class="at">legend.title.size=</span><span class="fl">0.7</span>, </span>
<span id="cb41-10"><a href="tutorial.html#cb41-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.title.fontface=</span><span class="dv">2</span>,</span>
<span id="cb41-11"><a href="tutorial.html#cb41-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.outside=</span><span class="cn">TRUE</span>,</span>
<span id="cb41-12"><a href="tutorial.html#cb41-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.outside.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>), </span>
<span id="cb41-13"><a href="tutorial.html#cb41-13" aria-hidden="true" tabindex="-1"></a>                                <span class="at">frame=</span><span class="cn">FALSE</span>, </span>
<span id="cb41-14"><a href="tutorial.html#cb41-14" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.text.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb41-15"><a href="tutorial.html#cb41-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend.width =</span> <span class="fl">0.35</span>)</span>
<span id="cb41-16"><a href="tutorial.html#cb41-16" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Let’s unpack this code; for the sake of completeness, we’ll go over all of the functions and arguments, rather than just the code that implements the changes mentioned above.</p>
<p>Above, to the right of the assignment operator, we have:</p>
<ul>
<li><code>tm_shape(worldmap_covid_data_economic)</code> specifies the spatial dataset with the information we want to map.</li>
<li>The <code>tm_polygons</code> function takes many arguments here:
<ul>
<li><code>col="mean_economic"</code> specifies the name of the column in the spatial dataset that contains the data we wish to map.</li>
<li><code>style=cont</code> indicates that we want a continuous legend</li>
<li><code>palette="BuGn"</code> specifies the color scheme we wish to use to represent variation in the data.</li>
<li><code>textNA="No Data</code> indicates that we want data coded as “NA” to be labeled “No Data” in our legend; the default label is “Missing”</li>
<li><code>title="Mean of Covid\nEconomic\nIntervention Index\n(1/1/2020 to\n 10/1/2020)"</code> specifies the title of the legend. The <code>\n</code> notation is used to indicate line breaks. If these are not included, the legend title would not contain line breaks, and would be one line. .</li>
<li><code>legend.is.portrait=FALSE</code> flips the legend, making its orientation horizontal rather than vertical</li>
<li><code>breaks=c(0,0.25,0.5,0.75)</code> specifies our custom breaks (for values of the Covid economic index) in the legend.</li>
</ul></li>
<li>The <code>tm_layout</code> function also takes many arguments:
<ul>
<li><code>legend.title.size=0.7</code> sets the size of the text in the legend’s title</li>
<li><code>legend.title.fontface=2</code> makes the legend title bold.</li>
<li><code>legend.position = c(0, 0)</code> positions the legend at the bottom-left of the map</li>
<li><code>frame=FALSE</code> removes the frame from the map</li>
<li><code>legend.text.size=0.5</code> specifies the size of the legend text that is not part of the legend title</li>
<li><code>legend.width=0.5</code> specifies the width of the legend</li>
</ul></li>
</ul>
<p>The best way to get a sense of how all of these various arguments work is to try changing the values of the arguments and inspect their effect on the map’s appearance.</p>
</div>
<div id="add-map-title-and-credits" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Add Map Title and Credits</h3>
<p>One useful thing to keep in mind is that when adding new elements to our map, it’s not necessary to retype all of our code; thus far, that is what we’ve been doing, but it’s also possible to simply append changes to the existing object. Below, to the right of the assignment operator, we first print the name of the object we want to modify (i.e. “covid_economic_map”) and then type a “+” sign; then, we can modify the object as desired. In particular, we want to add and customize a map title (which we will do by passing a few additional arguments through the now familiar <code>tm_layout</code> function), as well as add and customize a “Map Credits” section, which will include some basic map metadata.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="tutorial.html#cb42-1" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span>covid_economic_map<span class="sc">+</span></span>
<span id="cb42-2"><a href="tutorial.html#cb42-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">&quot;National Economic Support Measures</span><span class="sc">\n</span><span class="st">in Response to the Covid-19 Pandemic&quot;</span>, </span>
<span id="cb42-3"><a href="tutorial.html#cb42-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">main.title.position=</span><span class="st">&quot;center&quot;</span>,</span>
<span id="cb42-4"><a href="tutorial.html#cb42-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">main.title.size=</span><span class="dv">1</span>, </span>
<span id="cb42-5"><a href="tutorial.html#cb42-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">inner.margins=</span><span class="fu">c</span>(<span class="fl">0.06</span>,<span class="fl">0.10</span>,<span class="fl">0.10</span>,<span class="fl">0.08</span>), </span>
<span id="cb42-6"><a href="tutorial.html#cb42-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">attr.outside =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb42-7"><a href="tutorial.html#cb42-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">tm_credits</span>(<span class="st">&quot;Map Author: Aditya Ranganath</span><span class="sc">\n</span><span class="st">Dataset Author: Simon Porcher</span><span class="sc">\n</span><span class="st">CRS: WGS1984</span><span class="sc">\n</span><span class="st">Source: ICPSR&quot;</span>, </span>
<span id="cb42-8"><a href="tutorial.html#cb42-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position=</span><span class="fu">c</span>(<span class="fl">0.78</span>,<span class="dv">0</span>), </span>
<span id="cb42-9"><a href="tutorial.html#cb42-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="fl">0.38</span>)</span>
<span id="cb42-10"><a href="tutorial.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-11"><a href="tutorial.html#cb42-11" aria-hidden="true" tabindex="-1"></a>covid_economic_map </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Final Code</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="tutorial.html#cb43-1" aria-hidden="true" tabindex="-1"></a>covid_economic_map<span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(worldmap_covid_data_economic)<span class="sc">+</span></span>
<span id="cb43-2"><a href="tutorial.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;mean_economic&quot;</span>, </span>
<span id="cb43-3"><a href="tutorial.html#cb43-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;cont&quot;</span>, </span>
<span id="cb43-4"><a href="tutorial.html#cb43-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">palette=</span><span class="st">&quot;BuGn&quot;</span>, </span>
<span id="cb43-5"><a href="tutorial.html#cb43-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">textNA=</span><span class="st">&quot;No Data&quot;</span>, </span>
<span id="cb43-6"><a href="tutorial.html#cb43-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">title=</span><span class="st">&quot;Mean of Covid</span><span class="sc">\n</span><span class="st">Economic</span><span class="sc">\n</span><span class="st">Intervention Index</span><span class="sc">\n</span><span class="st">(1/1/2020 to</span><span class="sc">\n</span><span class="st"> 10/1/2020)&quot;</span>, </span>
<span id="cb43-7"><a href="tutorial.html#cb43-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.is.portrait=</span><span class="cn">FALSE</span>,</span>
<span id="cb43-8"><a href="tutorial.html#cb43-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>, <span class="fl">0.75</span>))<span class="sc">+</span></span>
<span id="cb43-9"><a href="tutorial.html#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.title.size=</span><span class="fl">0.7</span>, </span>
<span id="cb43-10"><a href="tutorial.html#cb43-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.fontface=</span><span class="dv">2</span>,</span>
<span id="cb43-11"><a href="tutorial.html#cb43-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside=</span><span class="cn">TRUE</span>,</span>
<span id="cb43-12"><a href="tutorial.html#cb43-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position=</span><span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>),</span>
<span id="cb43-13"><a href="tutorial.html#cb43-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame=</span><span class="cn">FALSE</span>, </span>
<span id="cb43-14"><a href="tutorial.html#cb43-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb43-15"><a href="tutorial.html#cb43-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width=</span><span class="fl">0.35</span>,</span>
<span id="cb43-16"><a href="tutorial.html#cb43-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title=</span><span class="st">&quot;National Economic Support Measures</span><span class="sc">\n</span><span class="st">in Response to the Covid-19 Pandemic&quot;</span>, </span>
<span id="cb43-17"><a href="tutorial.html#cb43-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position=</span><span class="st">&quot;center&quot;</span>,</span>
<span id="cb43-18"><a href="tutorial.html#cb43-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>, </span>
<span id="cb43-19"><a href="tutorial.html#cb43-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">inner.margins=</span><span class="fu">c</span>(<span class="fl">0.06</span>,<span class="fl">0.10</span>,<span class="fl">0.10</span>,<span class="fl">0.08</span>), </span>
<span id="cb43-20"><a href="tutorial.html#cb43-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">attr.outside =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb43-21"><a href="tutorial.html#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_credits</span>(<span class="st">&quot;Map Author: Aditya Ranganath</span><span class="sc">\n</span><span class="st">Dataset Author: Simon Porcher</span><span class="sc">\n</span><span class="st">CRS: WGS1984</span><span class="sc">\n</span><span class="st">Source: ICPSR&quot;</span>, </span>
<span id="cb43-22"><a href="tutorial.html#cb43-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">position=</span><span class="fu">c</span>(<span class="fl">0.78</span>,<span class="dv">0</span>), </span>
<span id="cb43-23"><a href="tutorial.html#cb43-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">0.38</span>)</span>
<span id="cb43-24"><a href="tutorial.html#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="tutorial.html#cb43-25" aria-hidden="true" tabindex="-1"></a>covid_economic_map</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
</div>
<div id="export-your-map" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Export Your Map</h2>
</div>
<div id="make-a-web-map" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Make a Web Map</h2>
</div>
<div id="summary" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Summary</h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>If we were to instead type <code>filter(iso_a3=="ATA)</code>, the function would <em>only</em> select the Antarctica row from the dataset and discard everything else.<a href="tutorial.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>It’s worth noting that when we are joining a tabular dataset to a spatial dataset with a view towards visualizing the information within the tabular data on a map, the object containing the spatial dataset should be listed before the object containing the tabular dataset. If we reverse this order, we’ll have to take some additional steps to get the joined dataset ready to map, and this is best avoided.<a href="tutorial.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="preliminaries-and-set-up.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practice-and-challenge-exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aranganath24/icpsr_mapping_manual/edit/master/04-main-lesson.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/aranganath24/icpsr_mapping_manual/blob/master/04-main-lesson.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
